"
<!DOCTYPE html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 8px;

        }

        .overflowtable {

            overflow-x: scroll;

        }

        .overflowtable th,
        .overflowtable td {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 0px;

            white-space: break-spaces;

            font-size: small;

        }

        .Page1 {

            height: auto;

        }

        .Page2 {

            height: auto;

        }
    </style>
</head>

<body style='font-family: Arial'>
    <div class='Page1'>

        <h1>CX Workflow</h1><br />
        <div>
            <h3>Form Name: Sales Tansfer Request<h3>
        </div>

        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>"&"##RequestID##" &"</td>
                    <td><b>Status: </b></td>
                    <td>"& LookUp(Statuses,StatusKey="Rejected").Status &"</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>"& STRRequestorInput.Text&"</td>
                    <td><b>Request Date: </b></td>
                    <td>"& Text(STRDateInput.SelectedDate,"dd-mmm-yyyy","en")&"</td>
                </tr>
                <tr>

                    <td><b>Requestor Country: </b></td>
                    <td>"&STR_CountryInput.SelectedText.Value&"</td>
                    <td><b>Local Currency: </b></td>
                    <td>"&STRCurrencyInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>SAP Document Number: </b></td>
                    <td>"&STRDocumentNo.Text&"</td>

                </tr>
                <tr>
                    <td><b>Ship to Number: </b></td>
                    <td>"&STRShipToPartyInput.Text&"</td>
                    <td><b>Sold to Number: </b></td>
                    <td>"&STRSoldToPartyInput.Text&"</td>
                </tr>
                <tr>
                    <td><b>Sales Organization: </b></td>
                    <td>"&STRServiceSalesOrgInput.SelectedText.Value &"</td>
                    <td><b>Customer Category: </b></td>
                    <td>"&STRRequestForInput.SelectedText.Value&"</td>
                </tr>

                <tr>
                    <td><b>Remarks: </b></td>
                    <td>"&STRRemarks.Text&"</td>


                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>"&"##ApprovalComments##"&"</td>
                </tr>
                <tr>

                    <td><b>Net Grand Total (USD): </b></td>
                    <td>"&NetGrandTotal.Text&"</td>
                </tr>


            </tbody>

        </table>
    </div>
    "&If(Option2, Concat(MaterialItem_STR_D.AllItems,
    "<div class='Page2'>
        <h3>Service Maintenance Contract</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Number of Months</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_1.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_1.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_StartDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_EndDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_1.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option3, Concat(MaterialItem_STR_SP.AllItems,
        "<h3>T&M Service Jobs & Spare Parts</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Service Notification no.</th>
                    <th>Quantity</th>
                    <th>Unit Price</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_2.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_NotificationNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Quantity_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitLocalPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitUSDPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_2.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option4, Concat(MaterialItem_STR_WE.AllItems,
        "<h3>Warranty Extension</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>Extension Period</th>
                    <th>Number of Years</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_3.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_3.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_3.SelectedText.Value & "</td>
                    <td>" & "After Warranty Expired" & "</td>
                    <td>" & ThisRecord.STR_DC_ExtensionPeriod_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_3.Text & "</td>
                </tr>"),"")

                &
                "

            </tbody>
        </table>
    </div>"
    & "
    <div class='Page2'>
        <h1> </h1>
        <h3>Approval Summary</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid' width='100%'>
            <tbody>
                <tr>
                    <th>Role</th>
                    <th>User</th>
                    <th>Comments</th>
                    <th>Date & Time(SGT)</th>
                </tr>
                <tr style='page-break-inside: avoid;'>
                    " & If(
                    Group13.Visible = true,
                    "
                    <td>" & TextInput1_340.Text & "</td>
                    <td>" & TextInput1_341.Text & "</td>
                    <td>" & TextInput1_342.Text & "</td>
                    <td>" & TextInput1_343.Text & "</td>
                    ",
                    ""
                    ) & "
                </tr>
                <tr style='page-break-inside: avoid;'>
                    " & If(
                    Group14.Visible = true,
                    "
                    <td>" & TextInput1_344.Text & "</td>
                    <td>" & TextInput1_345.Text & "</td>
                    <td>" & TextInput1_346.Text & "</td>
                    <td>" & TextInput1_347.Text & "</td>
                    ",
                    ""
                    ) & "
                </tr>
                <tr style='page-break-inside: avoid;'>
                    " & If(
                    Group12.Visible = true,
                    "
                    <td>" & TextInput1_348.Text & "</td>
                    <td>" & TextInput1_349.Text & "</td>
                    <td>" & TextInput1_350.Text & "</td>
                    <td>" & TextInput1_351.Text & "</td>
                    ",
                    ""
                    ) & "
                </tr>
                <tr style='page-break-inside: avoid;'>
                    " & If(
                    Group15.Visible = true,
                    "
                    <td>" & TextInput1_356.Text & "</td>
                    <td>" &
                        //Office365Users.MyProfileV2().displayName
                        TextInput1_357.Text & "</td>
                    <td>" & If(
                        IsBlank(PEExistingDetails.'Service Ops'),
                        "",
                        Trim(
                        First(
                        ForAll(
                        Split(
                        PESOCommentsDataCardValue.Text,
                        "##Timestamp:"
                        ),
                        {Result: ThisRecord.Value}
                        )
                        ).Result
                        )
                        ) & "</td>
                    <td>" & Trim(
                        Last(
                        ForAll(
                        Split(
                        LookUp(
                        PartsEscalationRequest,
                        ID = PEExistingDetails.ID
                        ).'SO Comments',
                        "##Timestamp:"
                        ),
                        {Result: ThisRecord.Value}
                        )
                        ).Result
                        )
                        //Text(
                        //DateAdd(
                        //DateAdd(
                        //Now(),
                        //TimeZoneOffset(),
                        //TimeUnit.Minutes
                        //),
                        //8,
                        //TimeUnit.Hours
                        //),
                        //"dd-mmm-yyyy hh:mm:ss AM/PM"
                        //)
                        & "</td>
                    ",
                    ""
                    ) & "
                </tr>
            </tbody>
        </table>
    </div>
</body>

</html>"



//Print Icon

"
<!DOCTYPE html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 8px;

        }

        .overflowtable {

            overflow-x: scroll;

        }

        .overflowtable th,
        .overflowtable td {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 0px;

            white-space: break-spaces;

            font-size: small;

        }

        .Page1 {

            height: auto;

        }

        .Page2 {

            height: auto;

        }
    </style>
</head>

<body style='font-family: Arial'>
    <div class="" Page1"">
        <h1>CX Workflow</h1><br />
        <div>
            <h3>Form Name: Sales Tansfer Request <h3>
        </div>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>"&STRRequestIdInput.Text &"</td>
                    <td><b>Status: </b></td>
                    <td>"& STRStatusInput.Selected.Value &"</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>"& STRRequestorInput.Text&"</td>
                    <td><b>Request Date: </b></td>
                    <td>"& Text(STRDateInput.SelectedDate,"dd-mmm-yyyy","en")&"</td>
                </tr>
                <tr>
                    <td><b>Requestor Country: </b></td>
                    <td>"&STR_CountryInput.SelectedText.Value&"</td>
                    <td><b>Local Currency: </b></td>
                    <td>"&STRCurrencyInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>SAP Document Number: </b></td>
                    <td>"&STRDocumentNo.Text&"</td>
                </tr>
                <tr>
                    <td><b>Sold to Number: </b></td>
                    <td>"&STRSoldToPartyInput.Text&"</td>
                    <td><b>Ship to Number: </b></td>
                    <td>"&STRShipToPartyInput.Text&"</td>


                </tr>
                <tr>

                    <td><b>Sales Organization: </b></td>
                    <td>"&STRServiceSalesOrgInput.SelectedText.Value &"</td>
                    <td><b>Customer Category: </b></td>
                    <td>"&STRRequestForInput.SelectedText.Value&"</td>

                </tr>
                <tr>

                    <td><b>Remarks: </b></td>
                    <td>"&STRRemarks.Text&"</td>


                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>"&STRApproverCommentInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>Net Grand Total (USD): </b></td>
                    <td>"&NetGrandTotal.Text&"</td>
                </tr>
            </tbody>
        </table>
    </div>

    "&
    If(Option2, Concat(MaterialItem_STR_D.AllItems,

    "<div class='Page2'>
        <h3>Service Maintenance Contract</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Number of Months</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>


                <tr>
                    <td>" & ThisRecord.STR_DC_Material_1.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_StartDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_EndDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_1.Text & "</td>
                </tr>"), "")& "
            </tbody>
        </table>"

        &If(Option3, Concat(MaterialItem_STR_SP.AllItems,
        "<h3>T&M Service Jobs & Spare Parts</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Service Notification no.</th>
                    <th>Quantity</th>
                    <th>Unit Price</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>

                <tr>
                    <td>" & ThisRecord.STR_DC_Material_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_NotificationNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Quantity_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitLocalPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitUSDPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_2.Text & "</td>
                </tr>"),"")&"
            </tbody>
        </table>"
        &If(Option4, Concat(MaterialItem_STR_WE.AllItems,
        "<h3>Warranty Extension</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>Extension Period</th>
                    <th>Number of Years</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>

                <tr>
                    <td>" & ThisRecord.STR_DC_Material_3.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_3.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_3.SelectedText.Value & "</td>
                    <td>" & "After Warranty Expired" & "</td>
                    <td>" & ThisRecord.STR_DC_ExtensionPeriod_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_3.Text & "</td>
                </tr>"),"")

                &

                "
            </tbody>
        </table>
    </div>"
    &" <div class='Page2'>
        <h1> </h1>
        <h3>Approval Summary</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid' width='100%'>
            <tbody>
                <tr>
                    <th>Role</th>
                    <th>User</th>
                    <th>Comments</th>
                    <th>Date & Time(SGT)</th>
                </tr>
                <tr style='page-break-inside: avoid;'>
                    " & If(
                    Group5_12.Visible = true,
                    "
                    <td>" & TextInput1_328.Text & "</td>
                    <td>" & TextInput1_329.Text & "</td>
                    <td>" & TextInput1_330.Text & "</td>
                    <td>" & TextInput1_331.Text & "</td>
                    ",
                    ""
                    ) & "
                </tr>
                <tr style='page-break-inside: avoid;'>
                    " & If(
                    Group4_12.Visible = true,
                    "
                    <td>" & TextInput1_332.Text & "</td>
                    <td>" & TextInput1_333.Text & "</td>
                    <td>" & TextInput1_334.Text & "</td>
                    <td>" & TextInput1_335.Text & "</td>
                    ",
                    ""
                    ) & "
                </tr>
                <tr style='page-break-inside: avoid;'>
                    " & If(
                    Group3_19.Visible = true,
                    "
                    <td>" & TextInput1_336.Text & "</td>
                    <td>" & TextInput1_337.Text & "</td>
                    <td>" & TextInput1_338.Text & "</td>
                    <td>" & TextInput1_339.Text & "</td>
                    ",
                    ""
                    ) & "
                </tr>
            </tbody>
        </table>
    </div>
</body>

</html>"


ST_SAP_2
"
<!DOCTYPE html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 8px;

        }

        .overflowtable {

            overflow-x: scroll;

        }

        .overflowtable th,
        .overflowtable td {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 0px;

            white-space: break-spaces;

            font-size: small;

        }

        .Page1 {

            height: auto;

        }

        .Page2 {

            height: auto;

        }
    </style>
</head>

<body style='font-family: Arial'>
    <div class='Page1'>

        <h1>CX Workflow</h1><br />
        <div>
            <h3>Form Name: Sales Tansfer Request<h3>
        </div>

        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>"&"##RequestID##" &"</td>
                    <td><b>Status: </b></td>
                    <td>"& LookUp(Statuses,StatusKey="Rejected").Status &"</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>"& STRRequestorInput.Text&"</td>
                    <td><b>Request Date: </b></td>
                    <td>"& Text(STRDateInput.SelectedDate,"dd-mmm-yyyy","en")&"</td>
                </tr>
                <tr>

                    <td><b>Requestor Country: </b></td>
                    <td>"&STR_CountryInput.SelectedText.Value&"</td>
                    <td><b>Local Currency: </b></td>
                    <td>"&STRCurrencyInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>SAP Document Number: </b></td>
                    <td>"&STRDocumentNo.Text&"</td>

                </tr>
                <tr>
                    <td><b>Ship to Number: </b></td>
                    <td>"&STRShipToPartyInput.Text&"</td>
                    <td><b>Sold to Number: </b></td>
                    <td>"&STRSoldToPartyInput.Text&"</td>
                </tr>
                <tr>
                    <td><b>Sales Organization: </b></td>
                    <td>"&STRServiceSalesOrgInput.SelectedText.Value &"</td>
                    <td><b>Customer Category: </b></td>
                    <td>"&STRRequestForInput.SelectedText.Value&"</td>
                </tr>

                <tr>
                    <td><b>Remarks: </b></td>
                    <td>"&STRRemarks.Text&"</td>


                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>"&"##ApprovalComments##"&"</td>
                </tr>
                <tr>

                    <td><b>Net Grand Total (USD): </b></td>
                    <td>"&NetGrandTotal.Text&"</td>
                </tr>


            </tbody>

        </table>
    </div>
    "&If(Option2, Concat(MaterialItem_STR_D.AllItems,
    "<div class='Page2'>
        <h3>Service Maintenance Contract</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Number of Months</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_1.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_1.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_StartDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_EndDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_1.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option3, Concat(MaterialItem_STR_SP.AllItems,
        "<h3>T&M Service Jobs & Spare Parts</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Service Notification no.</th>
                    <th>Quantity</th>
                    <th>Unit Price</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_2.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_NotificationNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Quantity_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitLocalPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitUSDPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_2.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option4, Concat(MaterialItem_STR_WE.AllItems,
        "<h3>Warranty Extension</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>Extension Period</th>
                    <th>Number of Years</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_3.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_3.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_3.SelectedText.Value & "</td>
                    <td>" & "After Warranty Expired" & "</td>
                    <td>" & ThisRecord.STR_DC_ExtensionPeriod_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_3.Text & "</td>
                </tr>"),"")

                &
                "

            </tbody>
        </table>
    </div>"
    &"
</body>

</html>"

STR_SAP_1

"
<!DOCTYPE html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 8px;

        }

        .overflowtable {

            overflow-x: scroll;

        }

        .overflowtable th,
        .overflowtable td {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 0px;

            white-space: break-spaces;

            font-size: small;

        }

        .Page1 {

            height: auto;

        }

        .Page2 {

            height: auto;

        }
    </style>
</head>

<body style='font-family: Arial'>
    <div class='Page1'>

        <h1>CX Workflow</h1><br />
        <div>
            <h3>Form Name: Sales Tansfer Request<h3>
        </div>

        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>"&"##RequestID##" &"</td>
                    <td><b>Status: </b></td>
                    <td>"& LookUp(Statuses,StatusKey="Closed").Status &"</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>"& STRRequestorInput.Text&"</td>
                    <td><b>Request Date: </b></td>
                    <td>"& Text(STRDateInput.SelectedDate,"dd-mmm-yyyy","en")&"</td>
                </tr>
                <tr>

                    <td><b>Requestor Country: </b></td>
                    <td>"&STR_CountryInput.SelectedText.Value&"</td>
                    <td><b>Local Currency: </b></td>
                    <td>"&STRCurrencyInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>SAP Document Number: </b></td>
                    <td>"&STRDocumentNo.Text&"</td>

                </tr>
                <tr>
                    <td><b>Ship to Number: </b></td>
                    <td>"&STRShipToPartyInput.Text&"</td>
                    <td><b>Sold to Number: </b></td>
                    <td>"&STRSoldToPartyInput.Text&"</td>
                </tr>
                <tr>
                    <td><b>Sales Organization: </b></td>
                    <td>"&STRServiceSalesOrgInput.SelectedText.Value &"</td>
                    <td><b>Customer Category: </b></td>
                    <td>"&STRRequestForInput.SelectedText.Value&"</td>
                </tr>

                <tr>
                    <td><b>Remarks: </b></td>
                    <td>"&STRRemarks.Text&"</td>


                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>"&"##ApprovalComments##"&"</td>
                </tr>
                <tr>

                    <td><b>Net Grand Total (USD): </b></td>
                    <td>"&NetGrandTotal.Text&"</td>
                </tr>


            </tbody>

        </table>
    </div>
    "&If(Option2, Concat(MaterialItem_STR_D.AllItems,
    "<div class='Page2'>
        <h3>Service Maintenance Contract</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Number of Months</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_1.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_1.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_StartDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_EndDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_1.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option3, Concat(MaterialItem_STR_SP.AllItems,
        "<h3>T&M Service Jobs & Spare Parts</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Service Notification no.</th>
                    <th>Quantity</th>
                    <th>Unit Price</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_2.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_NotificationNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Quantity_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitLocalPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitUSDPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_2.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option4, Concat(MaterialItem_STR_WE.AllItems,
        "<h3>Warranty Extension</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>Extension Period</th>
                    <th>Number of Years</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_3.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_3.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_3.SelectedText.Value & "</td>
                    <td>" & "After Warranty Expired" & "</td>
                    <td>" & ThisRecord.STR_DC_ExtensionPeriod_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_3.Text & "</td>
                </tr>"),"")

                &
                "

            </tbody>
        </table>
    </div>"
    &"
</body>

</html>"

STR_SAP

"
<!DOCTYPE html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 8px;

        }

        .overflowtable {

            overflow-x: scroll;

        }

        .overflowtable th,
        .overflowtable td {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 0px;

            white-space: break-spaces;

            font-size: small;

        }

        .Page1 {

            height: auto;

        }

        .Page2 {

            height: auto;

        }
    </style>
</head>

<body style='font-family: Arial'>
    <div class='Page1'>

        <h1>CX Workflow</h1><br />
        <div>
            <h3>Form Name: Sales Tansfer Request<h3>
        </div>

        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>"&"##RequestID##" &"</td>
                    <td><b>Status: </b></td>
                    <td>"& LookUp(Statuses,StatusKey="ActionRequiredSO").Status &"</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>"& STRRequestorInput.Text&"</td>
                    <td><b>Request Date: </b></td>
                    <td>"& Text(STRDateInput.SelectedDate,"dd-mmm-yyyy","en")&"</td>
                </tr>
                <tr>

                    <td><b>Requestor Country: </b></td>
                    <td>"&STR_CountryInput.SelectedText.Value&"</td>
                    <td><b>Local Currency: </b></td>
                    <td>"&STRCurrencyInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>SAP Document Number: </b></td>
                    <td>"&STRDocumentNo.Text&"</td>

                </tr>
                <tr>
                    <td><b>Ship to Number: </b></td>
                    <td>"&STRShipToPartyInput.Text&"</td>
                    <td><b>Sold to Number: </b></td>
                    <td>"&STRSoldToPartyInput.Text&"</td>
                </tr>
                <tr>
                    <td><b>Sales Organization: </b></td>
                    <td>"&STRServiceSalesOrgInput.SelectedText.Value &"</td>
                    <td><b>Customer Category: </b></td>
                    <td>"&STRRequestForInput.SelectedText.Value&"</td>
                </tr>

                <tr>
                    <td><b>Remarks: </b></td>
                    <td>"&STRRemarks.Text&"</td>


                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>"&"##ApprovalComments##"&"</td>
                </tr>
                <tr>

                    <td><b>Net Grand Total (USD): </b></td>
                    <td>"&NetGrandTotal.Text&"</td>
                </tr>


            </tbody>

        </table>
    </div>
    "&If(Option2, Concat(MaterialItem_STR_D.AllItems,
    "<div class='Page2'>
        <h3>Service Maintenance Contract</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Number of Months</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_1.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_1.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_StartDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_EndDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_1.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option3, Concat(MaterialItem_STR_SP.AllItems,
        "<h3>T&M Service Jobs & Spare Parts</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Service Notification no.</th>
                    <th>Quantity</th>
                    <th>Unit Price</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_2.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_NotificationNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Quantity_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitLocalPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitUSDPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_2.Text & "</td>
                </tr>"),"")&"
            </tbody>

        </table>"
        &If(Option4, Concat(MaterialItem_STR_WE.AllItems,
        "<h3>Warranty Extension</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>Extension Period</th>
                    <th>Number of Years</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>
                <tr>
                    <td>" & ThisRecord.STR_DC_Material_3.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_3.SelectedText.Model & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_3.SelectedText.Value & "</td>
                    <td>" & "After Warranty Expired" & "</td>
                    <td>" & ThisRecord.STR_DC_ExtensionPeriod_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_3.Text & "</td>
                </tr>"),"")

                &
                "

            </tbody>
        </table>
    </div>"
    &"
</body>

</html>"


replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
outputs('Get_item_18')?['body/SaveAsPdfContent'],
'##ApprovalComments##', outputs('Get_item_18')?['body/ApprovalComment']
),
'##RequestID##', outputs('Get_item_18')?['body/RequestID']
),
'##Logo##', variables('PDF Logo')
),
'##CM##', outputs('Get_item_18')?['body/CM/DisplayName']
),
'##CMComments##', split(outputs('Get_item_18')?['body/CMComments'], '##Timestamp:')[0]
),
'##RCHComments##', split(outputs('Get_item_18')?['body/RCHComments'], '##Timestamp:')[0]
),
'##RFDComments##', split(outputs('Get_item_18')?['body/RFDComments'], '##Timestamp:')[0]
),
'##RFDTimeStamp##', split(outputs('Get_item_18')?['body/RFDComments'], '##Timestamp:')[1]
),
'##RCHTimeStamp##', split(outputs('Get_item_18')?['body/RCHComments'], '##Timestamp:')[1]
),
'##CMTimeStamp##', split(outputs('Get_item_18')?['body/CMComments'], '##Timestamp:')[1]
),
'##RCH##', outputs('Get_item_18')?['body/RegionCommercialHead/DisplayName']
),
'##RFD##', outputs('Get_item_18')?['body/RegionFinance/DisplayName']
),
'##Status##', outputs('Get_item_18')?['body/Status/Value']
)




///This is perviously added to the service equipment Scope for PDF 5 Compose 4
replace(replace(replace(outputs('Get_item_18')?['body/SaveAsPdfContent'], '##ApprovalComments##',
outputs('Get_item_18')?['body/ApprovalComment']), '##RequestID##',
outputs('Get_item_18')?['body/RequestID']),'##Logo##',variables('PDF Logo'))


SALES TRANSFER PRINT ICON

"
<!DOCTYPE html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 8px;

        }

        .overflowtable {

            overflow-x: scroll;

        }

        .overflowtable th,
        .overflowtable td {

            border: 1px solid #dddddd;

            text-align: left;

            padding: 0px;

            white-space: break-spaces;

            font-size: small;

        }

        .Page1 {

            height: auto;

        }

        .Page2 {

            height: auto;

        }
    </style>
</head>

<body style='font-family: Arial'>
    <div class="" Page1"">
        <h1>CX Workflow</h1><br />
        <div>
            <h3>Form Name: Sales Tansfer Request <h3>
        </div>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>"&STRRequestIdInput.Text &"</td>
                    <td><b>Status: </b></td>
                    <td>"& STRStatusInput.Selected.Value &"</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>"& STRRequestorInput.Text&"</td>
                    <td><b>Request Date: </b></td>
                    <td>"& Text(STRDateInput.SelectedDate,"dd-mmm-yyyy","en")&"</td>
                </tr>
                <tr>
                    <td><b>Requestor Country: </b></td>
                    <td>"&STR_CountryInput.SelectedText.Value&"</td>
                    <td><b>Local Currency: </b></td>
                    <td>"&STRCurrencyInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>SAP Document Number: </b></td>
                    <td>"&STRDocumentNo.Text&"</td>
                </tr>
                <tr>
                    <td><b>Sold to Number: </b></td>
                    <td>"&STRSoldToPartyInput.Text&"</td>
                    <td><b>Ship to Number: </b></td>
                    <td>"&STRShipToPartyInput.Text&"</td>


                </tr>
                <tr>

                    <td><b>Sales Organization: </b></td>
                    <td>"&STRServiceSalesOrgInput.SelectedText.Value &"</td>
                    <td><b>Customer Category: </b></td>
                    <td>"&STRRequestForInput.SelectedText.Value&"</td>

                </tr>
                <tr>

                    <td><b>Remarks: </b></td>
                    <td>"&STRRemarks.Text&"</td>


                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>"&STRApproverCommentInput.Text&"</td>
                </tr>
                <tr>

                    <td><b>Net Grand Total (USD): </b></td>
                    <td>"&NetGrandTotal.Text&"</td>
                </tr>
            </tbody>
        </table>
    </div>

    "&
    If(Option2, Concat(MaterialItem_STR_D.AllItems,

    "<div class='Page2'>
        <h3>Service Maintenance Contract</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Number of Months</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>


                <tr>
                    <td>" & ThisRecord.STR_DC_Material_1.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_1.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_StartDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_EndDate_1.SelectedDate & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_1.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_1.Text & "</td>
                </tr>"), "")& "
            </tbody>
        </table>"

        &If(Option3, Concat(MaterialItem_STR_SP.AllItems,
        "<h3>T&M Service Jobs & Spare Parts</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Service Notification no.</th>
                    <th>Quantity</th>
                    <th>Unit Price</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>

                <tr>
                    <td>" & ThisRecord.STR_DC_Material_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_2.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_NotificationNo_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Quantity_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitLocalPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_UnitUSDPrice_2.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_2.Text & "</td>
                </tr>"),"")&"
            </tbody>
        </table>"
        &If(Option4, Concat(MaterialItem_STR_WE.AllItems,
        "<h3>Warranty Extension</h3>
        <table cellpadding='0' cellspacing='0' style='border 1px solid'>
            <tbody>
                <tr>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Equipment Number</th>
                    <th>Platform</th>
                    <th>Transfer Frequency</th>
                    <th>Start Date</th>
                    <th>Extension Period</th>
                    <th>Number of Years</th>
                    <th>Yearly Rate (USD)</th>
                    <th>Total Amount(USD)</th>
                </tr>

                <tr>
                    <td>" & ThisRecord.STR_DC_Material_3.SelectedText.Material & "</td>
                    <td>" & ThisRecord.STR_DC_MaterialDesc_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_EquipmentNo_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_Platform_3.SelectedText.Value & "</td>
                    <td>" & ThisRecord.STR_DC_TranferFreq_3.SelectedText.Value & "</td>
                    <td>" & "After Warranty Expired" & "</td>
                    <td>" & ThisRecord.STR_DC_ExtensionPeriod_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_NoOfMonth_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_YearlyRate_3.Text & "</td>
                    <td>" & ThisRecord.STR_DC_TotalAmt_3.Text & "</td>
                </tr>"),"")

                &

                "
            </tbody>
        </table>
    </div>"
    &"
</body>

</html>"


replace(
replace(
replace(
replace(
replace(
replace(
outputs('Closed_Email_Template_1')?['body/EmailBody'],
'##RejectedBy##',
outputs('Get_item_2')?['body/Editor/DisplayName']
),
'##RejectedComments##',
split(outputs('Get_item_2')?['body/SOComments'], '##Timestamp')[0]
),
'##Requestor##',
outputs('RequestorName')
),
'##DateInitiated##',
formatDateTime(triggerOutputs()?['body/RequestDate'], 'dd-MMM-yyyy')
),
'##DateRejected##',
formatDateTime(trim(split(split(outputs('Get_item_2')?['body/SOComments'], '##Timestamp:')[1], ' ')[0]), 'dd-MMM-yyyy')
),
'##FormName##',
variables('FormName')
)


Service Equipment Closure Email Replace Function
replace(replace(replace(replace(outputs('SAEmailTemplate_2')?['body/EmailBody'],'##SO##',outputs('LA_Names_3')),
'##FormName##', variables('FormName')), '##Requestor##', outputs('RequestorName')), '##DateInitiated##',
convertTimeZone(utcNow(), 'UTC', 'India Standard Time', 'dd-MMM-yyyy'))

replace(replace(replace(replace(outputs('SAEmailTemplate_2')?['body/EmailBody'],'##SO##',outputs('LA_Names_3')),
'##FormName##', variables('FormName')), '##Requestor##', outputs('RequestorName')), '##DateInitiated##',
FormatDateTime(utcNow(), 'dd-MMM-yyyy'))

replace(replace(replace(replace(replace(outputs('Closed_Email_Template_2')?['body/EmailBody'], '##Submitter##',
outputs('RequestorName')), '##FormName##', variables('FormName')), '##Requestor##', outputs('RequestorName')),
'##DateInitiated##', FormatDateTime(triggerOutputs()?['body/RequestDate'], 'dd-MMM-yyyy')), '##DateToday##',
convertTimeZone(utcNow(), 'UTC', 'India Standard Time', 'dd-MMM-yyyy'))


replace(replace(replace(replace(replace(replace(replace(replace(first(body('Rejected'))?['EmailBody'], '##Requestor##',
outputs('RequestorName')), '##RequestId##', triggerOutputs()?['body/Title']), '##RejectedBy##',
triggerOutputs()?['body/Editor/DisplayName']), '##DateInitiated##',
FormatDateTime(triggerOutputs()?['body/RequestDate'], 'dd-MMM-yyyy')), '##DateToday##', FormatDateTime(utcNow(),
'dd-MMM-yyyy')), '##FormName##', outputs('FormName')), '##RejectionComments##',
coalesce(split(outputs('Get_item_2')?['body/SOComments'],
'##Timestamp')[0])),'##DateRejected##',coalesce(formatDateTime(utcNow(), 'dd-MMM-yyyy')))




If(
PEExistingDetails.Status.Id = LookUp(
Statuses,
StatusKey = "Rejected"
).ID,
If(
IsEmpty(PEExistingDetails.RejectedBy.Value),
RGBA(
200,
16,
46,
1
),
If(
IsBlank(PEExistingDetails.'Service Ops'),
RGBA(
217,
217,
214,
1
),
RGBA(
108,
194,
74,
1
)
)
),
If(
IsBlank(SEQUExistingDetails.'Service Ops'),
RGBA(
255,
130,
0,
1
),
RGBA(
108,
194,
74,
1
)
)
)



If(PEExistingDetails.Status.Id=LookUp(Statuses,StatusKey="Rejected").ID,If("RFD" in
PEExistingDetails.RejectedBy.Value,RGBA(200,16,46,1),If(IsBlank(PEExistingDetails.'Regional Finance
Director'),RGBA(217,217,214,1),RGBA(108,194,74,1))),If(IsBlank(SEQUExistingDetails.'Regional Finance
Director'),RGBA(255,130,0,1),RGBA(108,194,74,1)))




replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(outputs('Get_item_18')?['body/SaveAsPdfContent'],
'##ApprovalComments##', outputs('Get_item_18')?['body/ApprovalComments']), '##RequestID##',
outputs('Get_item_18')?['body/RequestID']),'##Logo##',variables('PDF Logo'), '##CSM##',
outputs('Get_item_18')?['body/CSM/DisplayName']), '##CSMComments##', split(outputs('Get_item_18')?['body/CSMComments'],
"##Timestamp:")?[0]), '##CSMTimestamp##', split(outputs('Get_item_18')?['body/CSMComments'], "##Timestamp:")?[1]),
'##RFD##', outputs('Get_item_18')?['body/RFD/DisplayName']), '##RFDComments##',
split(outputs('Get_item_18')?['body/RFDComments'], "##Timestamp:")?[0]), '##RFDTimestamp##',
split(outputs('Get_item_18')?['body/RFDComments'], "##Timestamp:")?[1]), '##RCED##',
coalesce(outputs('Get_item_18')?['body/RCXD/DisplayName'], '')), '##RCEDComments##',
coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], "##Timestamp:")?[0], '')),'##RCEDTimestamp##',
coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], "##Timestamp:")?[1], '')), '##RBH##',
coalesce(outputs('Get_item_18')?['body/RBH/DisplayName'], '')), '##RBHComments##',
coalesce(split(outputs('Get_item_18')?['body/RBHComments'], "##Timestamp:")?[0], '')), '##RBHTimestamp##',
coalesce(split(outputs('Get_item_18')?['body/RBHComments'], "##Timestamp:")?[1], '')), '##BECH##',
coalesce(outputs('Get_item_18')?['body/GCXH/DisplayName'],'')), '##BECHComments##',
coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], "##Timestamp:")?[0], '')), '##BECHTimestamp##',
coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], "##Timestamp:")?[1], '')), '##SO##',
coalesce(outputs('Get_item_18')?['body/SO'],'')), '##SOComments##',
coalesce(split(outputs('Get_item_18')?['body/SOComments'], "##Timestamp:")?[0], '')), '##SOTimestamp##',
coalesce(split(outputs('Get_item_18')?['body/SOComments'], "##Timestamp:")?[1], ''))



replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
outputs('Get_item_18')?['body/SaveAsPdfContent'],
'##ApprovalComments##', outputs('Get_item_18')?['body/ApprovalComments']
),
'##RequestID##', outputs('Get_item_18')?['body/RequestID']
),
'##Logo##', variables('PDF Logo')
),
'##CSM##', outputs('Get_item_18')?['body/CSM/DisplayName']
),
'##CSMComments##', split(outputs('Get_item_18')?['body/CSMComments'], "##Timestamp:")?[0]
),
'##CSMTimestamp##', split(outputs('Get_item_18')?['body/CSMComments'], "##Timestamp:")?[1]
),
'##RFD##', outputs('Get_item_18')?['body/RFD/DisplayName']
),
'##RFDComments##', split(outputs('Get_item_18')?['body/RFDComments'], "##Timestamp:")?[0]
),
'##RFDTimestamp##', split(outputs('Get_item_18')?['body/RFDComments'], "##Timestamp:")?[1]
),
'##RCED##', coalesce(outputs('Get_item_18')?['body/RCXD/DisplayName'], '')
),
'##RCEDComments##', coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], "##Timestamp:")?[0], '')
),
'##RCEDTimestamp##', coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], "##Timestamp:")?[1], '')
),
'##RBH##', coalesce(outputs('Get_item_18')?['body/RBH/DisplayName'], '')
),
'##RBHComments##', coalesce(split(outputs('Get_item_18')?['body/RBHComments'], "##Timestamp:")?[0], '')
),
'##RBHTimestamp##', coalesce(split(outputs('Get_item_18')?['body/RBHComments'], "##Timestamp:")?[1], '')
),
'##BECH##', coalesce(outputs('Get_item_18')?['body/GCXH/DisplayName'], '')
),
'##BECHComments##', coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], "##Timestamp:")?[0], '')
),
'##BECHTimestamp##', coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], "##Timestamp:")?[1], '')
),
'##SO##', coalesce(outputs('Get_item_18')?['body/SO'], '')
),
'##SOComments##', coalesce(split(outputs('Get_item_18')?['body/SOComments'], "##Timestamp:")?[0], '')
),
'##SOTimestamp##', coalesce(split(outputs('Get_item_18')?['body/SOComments'], "##Timestamp:")?[1], '')
)

replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
outputs('Get_item_18')?['body/SaveAsPdfContent'],
'##ApprovalComments##', outputs('Get_item_18')?['body/ApprovalComments']
),
'##RequestID##', outputs('Get_item_18')?['body/RequestID']
),
'##Logo##', variables('PDF Logo')
),
'##CSM##', outputs('Get_item_18')?['body/CSM/DisplayName']
),
'##CSMComments##', split(outputs('Get_item_18')?['body/CSMComments'], "##Timestamp:")?[0]
),
'##CSMTimestamp##', split(outputs('Get_item_18')?['body/CSMComments'], "##Timestamp:")?[1]
),
'##RFD##', outputs('Get_item_18')?['body/RFD/DisplayName']
),
'##RFDComments##', split(outputs('Get_item_18')?['body/RFDComments'], "##Timestamp:")?[0]
),
'##RFDTimestamp##', split(outputs('Get_item_18')?['body/RFDComments'], "##Timestamp:")?[1]
),
'##RCED##', coalesce(outputs('Get_item_18')?['body/RCXD/DisplayName'], '')
),
'##RCEDComments##', coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], "##Timestamp:")?[0], '')
),
'##RCEDTimestamp##', coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], "##Timestamp:")?[1], '')
),
'##RBH##', coalesce(outputs('Get_item_18')?['body/RBH/DisplayName'], '')
),
'##RBHComments##', coalesce(split(outputs('Get_item_18')?['body/RBHComments'], "##Timestamp:")?[0], '')
),
'##RBHTimestamp##', coalesce(split(outputs('Get_item_18')?['body/RBHComments'], "##Timestamp:")?[1], '')
),
'##BECH##', coalesce(outputs('Get_item_18')?['body/GCXH/DisplayName'], '')
),
'##BECHComments##', coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], "##Timestamp:")?[0], '')
),
'##BECHTimestamp##', coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], "##Timestamp:")?[1], '')
),
'##SO##', coalesce(outputs('Get_item_18')?['body/SO'], '')
),
'##SOComments##', coalesce(split(outputs('Get_item_18')?['body/SOComments'], "##Timestamp:")?[0], '')
),
'##SOTimestamp##', coalesce(split(outputs('Get_item_18')?['body/SOComments'], "##Timestamp:")?[1], '')
)




{
"@odata.etag": "\"17\"",
"ItemInternalId": "106",
"ID": 106,
"SpecialPricingDate": "2024-12-17",
"LocalCurrency": "AUD",
"CustomerAccountNumber": "16516351",
"CustomerName": "HARI",
"Remarks": "PDF TEST",
"RequestID": "POR-17Dec2024-00106",
"ApprovalComments": "\nRBH :TEST PDF\r\nRFD :PDF TEST \nGCXH :TEST TEST SO:",
"Status": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
"Id": 14,
"Value": "Fully Approved (Pending with SO)"
},
"Status#Id": 14,
"WorkFlowPendingWith": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
"Id": -1,
"Value": "SO"
},
"WorkFlowPendingWith#Id": -1,
"Requestor": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|ukumar28@its.jnj.com",
"DisplayName": "Kumar, Udhaya [GTSSG NON-J&J]",
"Email": "UKumar28@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=UKumar28@ITS.JNJ.com",
"Department": "77589_ASPAC Global S"
},
"Requestor#Claims": "i:0#.f|membership|ukumar28@its.jnj.com",
"Modified": "2024-12-17T10:43:11Z",
"RFD": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|hsahoo1@its.jnj.com",
"DisplayName": "Sahoo, Harichandan [MEDJP NON-J&J]",
"Email": "HSahoo1@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=HSahoo1@ITS.JNJ.com",
"Department": "ITS Program Support",
"JobTitle": null
},
"RFD#Claims": "i:0#.f|membership|hsahoo1@its.jnj.com",
"RejectedBy": [],
"RejectedBy@odata.type": "#Collection(Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference)",
"RejectedBy#Id": [],
"RejectedBy#Id@odata.type": "#Collection(Int64)",
"RFDComments": "PDF TEST ##Timestamp:17-Dec-2024 06:41:09 PM",
"Platform": "Catalys",
"EquipmentSerialNo": "5156132512",
"ContractNo": "5156132512",
"ContractStartDate": "2024-12-17",
"ContractEndDate": "2024-12-31",
"ServiceNotificationNo": "5156132512",
"NotificationDate": "2024-12-18",
"TotalPriceChange": -92,
"Country": "AUSTRALIA",
"GCXH": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|hsahoo1@its.jnj.com",
"DisplayName": "Sahoo, Harichandan [MEDJP NON-J&J]",
"Email": "HSahoo1@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=HSahoo1@ITS.JNJ.com",
"Department": "ITS Program Support",
"JobTitle": null
},
"GCXH#Claims": "i:0#.f|membership|hsahoo1@its.jnj.com",
"GCXHComments": "TEST TEST ##Timestamp:17-Dec-2024 06:42:57 PM",
"Department": "Services",
"PreviousPrice": 1000,
"NewPrice": 80,
"RCXD": "HSahoo1@ITS.JNJ.com",
"RCXDComments": "TEST PDF ##Timestamp:17-Dec-2024 06:41:10 PM",
"WorkFlowTimeout": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
"Id": 1,
"Value": "NO"
},
"WorkFlowTimeout#Id": 1,
"DateDiff": "",
"Created": "2024-12-17T10:38:28Z",
"Author": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|hsahoo1@its.jnj.com",
"DisplayName": "Sahoo, Harichandan [MEDJP NON-J&J]",
"Email": "HSahoo1@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=HSahoo1@ITS.JNJ.com",
"Department": "ITS Program Support"
},
"Author#Claims": "i:0#.f|membership|hsahoo1@its.jnj.com",
"Editor": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|slim76@its.jnj.com",
"DisplayName": "Lim, Shanan [VISAP]",
"Email": "SLim76@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=SLim76@ITS.JNJ.com",
"Department": "Reg Cat OH Alloc",
"JobTitle": "Associate Director Customer Operations"
},
"Editor#Claims": "i:0#.f|membership|slim76@its.jnj.com",
"{Identifier}": "Lists%252fPriceOverride%252f106_.000",
"{IsFolder}": false,
"{Thumbnail}": {
"Large": null,
"Medium": null,
"Small": null
},
"{Link}":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/listform.aspx?PageType=4&ListId=d6e93fd0%2D7463%2D4c32%2Db79d%2Ded15724ccb39&ID=106&ContentTypeID=0x010014F648176457EF42B0CE1F63CB0CFE2E",
"{Name}": "",
"{FilenameWithExtension}": "",
"{Path}": "Lists/PriceOverride/",
"{FullPath}": "Lists/PriceOverride/106_.000",
"{HasAttachments}": false,
"{VersionNumber}": "17.0"
}


replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(outputs('Get_item_18')?['body/SaveAsPdfContent'],'##ApprovalComments##',outputs('Get_item_18')?['body/ApprovalComments']),'##RequestID##',outputs('Get_item_18')?['body/RequestID']),'##Logo##',variables('PDF
Logo')),'##CSM##',outputs('Get_item_18')?['body/CSM/DisplayName']),'##CSMComments##',split(outputs('Get_item_18')?['body/CSMComments'],'##Timestamp:')?[0]),'##CSMTimestamp##',split(outputs('Get_item_18')?['body/CSMComments'],'##Timestamp:')?[1]),'##RFD##',outputs('Get_item_18')?['body/RFD/DisplayName']),'##RFDComments##',split(outputs('Get_item_18')?['body/RFDComments'],'##Timestamp:')?[0]),'##RFDTimestamp##',split(outputs('Get_item_18')?['body/RFDComments'],'##Timestamp:')?[1]),'##RCED##',coalesce(outputs('Get_item_18')?['body/RCXD/DisplayName'],'')),'##RCEDComments##',coalesce(split(outputs('Get_item_18')?['body/RCXDComments'],'##Timestamp:')?[0],'')),'##RCEDTimestamp##',coalesce(split(outputs('Get_item_18')?['body/RCXDComments'],'##Timestamp:')?[1],'')),'##RBH##',coalesce(outputs('Get_item_18')?['body/RBH/DisplayName'],'')),'##RBHComments##',coalesce(split(outputs('Get_item_18')?['body/RBHComments'],'##Timestamp:')?[0],'')),'##RBHTimestamp##',coalesce(split(outputs('Get_item_18')?['body/RBHComments'],'##Timestamp:')?[1],'')),'##BECH##',coalesce(outputs('Get_item_18')?['body/GCXH/DisplayName'],'')),'##BECHComments##',coalesce(split(outputs('Get_item_18')?['body/GCXHComments'],'##Timestamp:')?[0],'')),'##BECHTimestamp##',coalesce(split(outputs('Get_item_18')?['body/GCXHComments'],'##Timestamp:')?[1],'')),'##SO##',coalesce(outputs('Get_item_18')?['body/SO'],'')),'##SOComments##',coalesce(split(outputs('Get_item_18')?['body/SOComments'],'##Timestamp:')?[0],'')),'##SOTimestamp##',coalesce(split(outputs('Get_item_18')?['body/SOComments'],'##Timestamp:')?[1],''))



replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
outputs('Get_item_18')?['body/SaveAsPdfContent'],
'##ApprovalComments##', coalesce(outputs('Get_item_18')?['body/ApprovalComments'], '')
),
'##RequestID##', coalesce(outputs('Get_item_18')?['body/RequestID'], '')
),
'##Logo##', coalesce(variables('PDF Logo'), '')
),
'##CSM##', coalesce(outputs('Get_item_18')?['body/CSM/DisplayName'], '')
),
'##CSMComments##', coalesce(split(outputs('Get_item_18')?['body/CSMComments'], '##Timestamp:')?[0], '')
),
'##CSMTimestamp##', coalesce(split(outputs('Get_item_18')?['body/CSMComments'], '##Timestamp:')?[1], '')
),
'##RFD##', coalesce(outputs('Get_item_18')?['body/RFD/DisplayName'], '')
),
'##RFDComments##', coalesce(split(outputs('Get_item_18')?['body/RFDComments'], '##Timestamp:')?[0], '')
),
'##RFDTimestamp##', coalesce(split(outputs('Get_item_18')?['body/RFDComments'], '##Timestamp:')?[1], '')
),
'##RCED##', coalesce(outputs('Get_item_18')?['body/RCXD/DisplayName'], '')
),
'##RCEDComments##', coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], '##Timestamp:')?[0], '')
),
'##RCEDTimestamp##', coalesce(split(outputs('Get_item_18')?['body/RCXDComments'], '##Timestamp:')?[1], '')
),
'##RBH##', coalesce(outputs('Get_item_18')?['body/RBH/DisplayName'], '')
),
'##RBHComments##', coalesce(split(outputs('Get_item_18')?['body/RBHComments'], '##Timestamp:')?[0], '')
),
'##RBHTimestamp##', coalesce(split(outputs('Get_item_18')?['body/RBHComments'], '##Timestamp:')?[1], '')
),
'##BECH##', coalesce(outputs('Get_item_18')?['body/GCXH/DisplayName'], '')
),
'##BECHComments##', coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], '##Timestamp:')?[0], '')
),
'##BECHTimestamp##', coalesce(split(outputs('Get_item_18')?['body/GCXHComments'], '##Timestamp:')?[1], '')
),
'##SO##', coalesce(outputs('Get_item_18')?['body/SO'], '')
),
'##SOComments##', coalesce(split(outputs('Get_item_18')?['body/SOComments'], '##Timestamp:')?[0], '')
),
'##SOTimestamp##', coalesce(split(outputs('Get_item_18')?['body/SOComments'], '##Timestamp:')?[1], '')
)



replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
outputs('Get_item_18')?['body']?['SaveAsPdfContent'],
'##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
),
'##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
),
'##Logo##', coalesce(variables('PDF Logo'), '')
),
'##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
),
'##CSMComments##', split(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), '##Timestamp:')?[0],
),
'##CSMTimestamp##', coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], '')
),
'##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
),
'##RFDComments##', coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], '')
),
'##RFDTimestamp##', coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], '')
),
'##RCED##', coalesce(outputs('Get_item_18')?['body']?['RCXD']?['DisplayName'], '')
),
'##RCEDComments##', coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], '')
),
'##RCEDTimestamp##', coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], '')
),
'##RBH##', coalesce(outputs('Get_item_18')?['body']?['RBH']?['DisplayName'], '')
),
'##RBHComments##', coalesce(split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[0], '')
),
'##RBHTimestamp##', coalesce(split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[1], '')
),
'##BECH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
),
'##BECHComments##', coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], '')
),
'##BECHTimestamp##', coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], '')
),
'##SO##', coalesce(outputs('Get_item_18')?['body']?['SO']['DisplayName'], '')
),
'##SOComments##', coalesce(split(outputs('Get_item_18')?['body']?['SOComments'], '##Timestamp:')?[0], '')
),
'##SOTimestamp##', coalesce(split(outputs('Get_item_18')?['body']?['SOComments'], '##Timestamp:')?[1], '')
)




concat(
if(equals(triggerOutputs()?['body/Author/Email'], null), '', triggerOutputs()?['body/Author/Email']), ';',
if(equals(triggerBody()?['RCXD/Email'], null), '', triggerBody()?['RCXD/Email']), ';',
if(equals(triggerBody()?['RFD/Email'], null), '', triggerBody()?['RFD/Email']), ';',
if(equals(triggerBody()?['GCXH/Email'], null), '', triggerBody()?['GCXH/Email']), ';'
)



replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
outputs('Get_item_18')?['body']?['SaveAsPdfContent'],
'##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
),
'##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
),
'##Logo##', coalesce(variables('PDF Logo'), '')
),
'##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
),
'##CSMComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0])
),
'##CSMTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1])
),
'##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
),
'##RFDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0])
),
'##RFDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1])
),
'##RCED##', coalesce(outputs('Get_item_18')?['body']?['RCXD']?['DisplayName'], '')
),
'##RCEDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0])
),
'##RCEDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1])
),
'##RBH##', coalesce(outputs('Get_item_18')?['body']?['RBH']?['DisplayName'], '')
),
'##RBHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[0])
),
'##RBHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[1])
),
'##BECH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
),
'##BECHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0])
),
'##BECHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1])
),
'##SO##', coalesce(outputs('Get_item_18')?['body']?['SO']?['DisplayName'], '')
),
'##SOComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['SOComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['SOComments'], '##Timestamp:')?[0])
),
'##SOTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['SOComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['SOComments'], '##Timestamp:')?[1])
)



replace(replace(replace(replace(outputs('SAEmailTemplate_1')?['body/EmailBody'],'##SO##',outputs('Get_item_1')?['body/SO/DisplayName']),'##FormName##',
variables('FormName')), '##Requestor##', outputs('RequestorName')), '##DateInitiated##', FormatDateTime(utcNow(),
'dd-MMM-yyyy'))



replace(replace(replace(replace(outputs('SAEmailTemplate_1')?['body/EmailBody'],'##SO##',outputs('Get_items_2')?['body/SO/DisplayName']),'##FormName##',
variables('FormName')), '##Requestor##', outputs('RequestorName')), '##DateInitiated##', FormatDateTime(utcNow(),
'dd-MMM-yyyy'))




[
{
"@odata.etag": "\"13\"",
"ItemInternalId": "60",
"ID": 60,
"Country": "JAPAN",
"Created": "2024-12-18T09:55:38Z",
"RequestID": "STRF-18Dec2024-00060",
"Author": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
"Email": "PBiswa27@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
"Department": "ITS Program Support",
"JobTitle": null
},
"Author#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"RequestDate": "2024-12-18",
"SoldToParty": "8748274234",
"ShipToParty": "21323",
"RequestFor": "Direct Customers",
"ExchangeRate": 145.8151064,
"Currency": "JPY",
"NetGrandTotal": 0,
"Remarks": "dasdsdadsd",
"Status": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
"Id": 14,
"Value": "Fully Approved (Pending with SO)"
},
"Status#Id": 14,
"GrandTotalForDistributors": 0,
"GrandTotalForSpareParts": 0,
"GrandTotalForWarrantyExtension": 0,
"GMComments": "test approve ##Timestamp:18-Dec-2024 08:58:04 PM",
"BUFComments": "test approve ##Timestamp:18-Dec-2024 08:58:36 PM",
"ServiceSalesOrganization": "3811",
"WorkFlowPendingWith": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
"Id": 2,
"Value": "SO"
},
"WorkFlowPendingWith#Id": 2,
"WorkFlowTimeout": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
"Id": 1,
"Value": "NO"
},
"WorkFlowTimeout#Id": 1,
"DateDiff": "",
"GeneralManager": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
"Email": "PBiswa27@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
"Department": "ITS Program Support",
"JobTitle": null
},
"GeneralManager#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"Modified": "2024-12-18T09:58:39Z",
"Editor": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|slim76@its.jnj.com",
"DisplayName": "Lim, Shanan [VISAP]",
"Email": "SLim76@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=SLim76@ITS.JNJ.com",
"Department": "Reg Cat OH Alloc",
"JobTitle": "Associate Director Customer Operations"
},
"Editor#Claims": "i:0#.f|membership|slim76@its.jnj.com",
"Requestor": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
"Email": "PBiswa27@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
"Department": "ITS Program Support",
"JobTitle": null
},
"Requestor#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"SaveAsPdfContent": "\n
<!DOCTYPE html>\n

<head>\n <style>
        \n h1 {
            \n color: black;
            \n
        }

        \n td,
        \n th {
            \n border: 1px solid #dddddd;
            \n text-align: left;
            \n padding: 8px;
            \n
        }

        \n .overflowtable {
            \n overflow-x: scroll;
            \n
        }

        \n .overflowtable th,
        \n .overflowtable td {
            \n border: 1px solid #dddddd;
            \n text-align: left;
            \n padding: 0px;
            \n white-space: break-spaces;
            \n font-size: small;
            \n
        }

        \n .Page1 {
            \n height: auto;
            \n
        }

        \n .Page2 {
            \n height: auto;
            \n
        }

        \n
    </style>\n</head>\n

<body style='font-family: Arial'>\n <div class=\" Page1\">\n <h1>CX Workflow</h1><br />\n <div>\n <h3>Form Name: Sales
                Tansfer Request <h3>\n </div>\n <table cellpadding='0' cellspacing='0' style='border 1px solid'>\n
            <tbody>\n <tr>\n <td><b>Request ID: </b></td>\n <td></td>\n <td><b>Status: </b></td>\n <td></td>\n </tr>\n
                <tr>\n <td><b>Requestor: </b></td>\n <td>Pritam Biswas</td>\n <td><b>Request Date: </b></td>\n <td>
                        18-Dec-2024</td>\n </tr>\n <tr>\n <td><b>Requestor Country: </b></td>\n <td>JAPAN</td>\n <td>
                        <b>Local Currency: </b></td>\n <td>JPY</td>\n </tr>\n <tr>\n <td><b>SAP Document Number: </b>
                    </td>\n <td></td>\n </tr>\n <tr>\n <td><b>Sold to Number: </b></td>\n <td>8748274234</td>\n <td>
                        <b>Ship to Number: </b></td>\n <td>21323</td>\n\n </tr>\n <tr>\n <td><b>Sales Organization: </b>
                    </td>\n <td>3811</td>\n <td><b>Customer Category: </b></td>\n <td>Direct Customers</td>\n </tr>\n
                <tr>\n <td><b>Remarks: </b></td>\n <td>dasdsdadsd</td>\n\n </tr>\n <tr>\n <td><b>Approval Comments: </b>
                    </td>\n <td></td>\n </tr>\n <tr>\n <td><b>Net Grand Total (USD): </b></td>\n <td>$0.00</td>\n </tr>
                \n </tbody>\n </table>\n </div>\n <div class='Page2'>\n <h3>Service Maintenance Contract</h3>\n <table
            cellpadding='0' cellspacing='0' style='border 1px solid'>\n <tbody>\n <tr>\n <th>Material</th>\n <th>
                        Material Description</th>\n <th>Equipment Number</th>\n <th>Platform</th>\n <th>Transfer
                        Frequency</th>\n <th>Start Date</th>\n <th>End Date</th>\n <th>Number of Months</th>\n <th>
                        Yearly Rate (USD)</th>\n <th>Total Amount(USD)</th>\n </tr>\n\n <tr>\n <td></td>\n <td></td>\n
                    <td>234324</td>\n <td>Catalys</td>\n <td>Monthly</td>\n <td>12/18/2024</td>\n <td>12/31/2024</td>\n
                    <td>0.00</td>\n <td>30,000.00</td>\n <td>$0.00</td>\n </tr>\n </tbody>\n </table>\n </tbody>\n
        </table>\n </tbody>\n </table>\n </div>
    <div class='Page2'>\n <h1> </h1>\n <h3>Approval Summary</h3>\n <table cellpadding='0' cellspacing='0'
            style='border 1px solid' width='100%'>\n <tbody>\n <tr>\n <th>Role</th>\n <th>User</th>\n <th>Comments</th>
                    \n <th>Date & Time(SGT)</th>\n </tr>\n <tr style='page-break-inside: avoid;'>\n \n <td>General
                        Manager</td>\n <td></td>\n <td></td>\n <td></td>\n \n </tr>\n <tr
                    style='page-break-inside: avoid;'>\n \n <td>Business Unit Finance</td>\n <td></td>\n <td></td>\n
                    <td></td>\n \n </tr>\n <tr style='page-break-inside: avoid;'>\n \n <td>Service Ops</td>\n <td></td>
                    \n <td></td>\n <td></td>\n \n </tr>\n </tbody>\n </table>\n </div>\n
</body>\n

</html>",
"BusinessUnitFinance": {
"@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
"Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
"Email": "PBiswa27@ITS.JNJ.com",
"Picture":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
"Department": "ITS Program Support",
"JobTitle": null
},
"BusinessUnitFinance#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
"ApprovalComments": "\nGM :test approve\nBUF :test approve",
"test": "2024-12-18T09:55:38Z",
"{Identifier}": "Lists%252fSalesTransferRequest%252f60_.000",
"{IsFolder}": false,
"{Thumbnail}": {
"Large": null,
"Medium": null,
"Small": null
},
"{Link}":
"https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/listform.aspx?PageType=4&ListId=be29e43c%2D57ee%2D4ea6%2Dafbb%2D1aaea4ae008f&ID=60&ContentTypeID=0x01008C9D3AD4AC04E2459C74E3643FB8A84E",
"{Name}": "",
"{FilenameWithExtension}": "",
"{Path}": "Lists/SalesTransferRequest/",
"{FullPath}": "Lists/SalesTransferRequest/60_.000",
"{HasAttachments}": false,
"{VersionNumber}": "13.0"
}
]


replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(outputs('Get_item_18')?['body/SaveAsPdfContent'],
'##ApprovalComments##', outputs('Get_item_18')?['body/ApprovalComments']), '##RequestID##',
outputs('Get_item_18')?['body/RequestID']),
'##Logo##',variables('PDF Logo')),'Service Maintance Contract for Distributor','Service Maintenance Contract'),
'##Status##', outputs('Get_item_18')?['body/Status/Value']), '##GM##', outputs('Get_item_18')?['body/GM/DisplayName']),
'##GMComments##', split(outputs('Get_item_18')?['body']?['GMComments'], '##Timestamp:')?[0]), '##GMTimestamp##',
split(outputs('Get_item_18')?['body']?['GMComments'], '##Timestamp:')?[1]), '##BUF##',
outputs('Get_item_18')?['body/BUF/DisplayName']), '##BUFComments##',
split(outputs('Get_item_18')?['body']?['BUFComments'], '##Timestamp:')?[0]), '##BUFTimestamp##',
split(outputs('Get_item_18')?['body']?['BUFComments'], '##Timestamp:')?[1]), '##SO##',
outputs('Get_item_18')?['body/SO/DisplayName']), '##SOComments##', split(outputs('Get_item_18')?['body']?['SOComments'],
'##Timestamp:')?[0]), '##SOTimestamp##', split(outputs('Get_item_18')?['body']?['SOComments'], '##Timestamp:')?[1])


replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
coalesce(outputs('Get_item_18')?['body/SaveAsPdfContent'], ''),
'##ApprovalComments##',
coalesce(outputs('Get_item_18')?['body/ApprovalComments'], '')
),
'##RequestID##',
coalesce(outputs('Get_item_18')?['body/RequestID'], '')
),
'##Logo##',
coalesce(variables('PDF Logo'), '')
),
'Service Maintance Contract for Distributor',
'Service Maintenance Contract'
),
'##Status##',
coalesce(outputs('Get_item_18')?['body/Status/Value'], '')
),
'##GM##',
coalesce(outputs('Get_item_18')?['body/GeneralManager/DisplayName'], '')
),
'##GMComments##',
coalesce(split(coalesce(outputs('Get_item_18')?['body']?['GMComments'], ''), '##Timestamp:')?[0], '')
),
'##GMTimestamp##',
coalesce(split(coalesce(outputs('Get_item_18')?['body']?['GMComments'], ''), '##Timestamp:')?[1], '')
),
'##BUF##',
coalesce(outputs('Get_item_18')?['body/BusinessUnitFinance/DisplayName'], '')
),
'##BUFComments##',
coalesce(split(coalesce(outputs('Get_item_18')?['body']?['BUFComments'], ''), '##Timestamp:')?[0], '')
),
'##BUFTimestamp##',
coalesce(split(coalesce(outputs('Get_item_18')?['body']?['BUFComments'], ''), '##Timestamp:')?[1], '')
)


replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
outputs('Get_item_18')?['body']?['SaveAsPdfContent'],
'##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
),
'##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
),
'##Logo##', coalesce(variables('PDF Logo'), '')
),
'##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
),
'##CSMComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0])
),
'##CSMTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1])
),
'##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
),
'##RFDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0])
),
'##RFDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1])
),
'##RCED##', coalesce(outputs('Get_item_18')?['body']?['RCXD']?['DisplayName'], '')
),
'##RCEDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0])
),
'##RCEDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1])
),
'##RBH##', coalesce(outputs('Get_item_18')?['body']?['RBH']?['DisplayName'], '')
),
'##RBHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[0])
),
'##RBHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[1])
),
'##BECH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
),
'##BECHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0])
),
'##BECHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1])
)


replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
'##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
),
'##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
),
'##Logo##', coalesce(variables('PDF Logo'), '')
),
'##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
),
'##CSMComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], ''))
),
'##CSMTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], ''))
),
'##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
),
'##RFDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], ''))
),
'##RFDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], ''))
),
'##RCED##', coalesce(outputs('Get_item_18')?['body']?['RCXD']?['DisplayName'], '')
),
'##RCEDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], ''))
),
'##RCEDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], ''))
),
'##RBH##', coalesce(outputs('Get_item_18')?['body']?['RBH']?['DisplayName'], '')
),
'##RBHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[0], ''))
),
'##RBHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[1], ''))
),
'##BECH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
),
'##BECHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], ''))
),
'##BECHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], ''))
)




///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
replace(
coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
'##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
),
'##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
),
'##Logo##', coalesce(variables('PDF Logo'), '')
),
'##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
),
'##CSMComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], ''))
),
'##CSMTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], ''))
),
'##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
),
'##RFDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], ''))
),
'##RFDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], ''))
),
'##RCED##', coalesce(outputs('Get_item_18')?['body']?['RCXD']?['DisplayName'], '')
),
'##RCEDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], ''))
),
'##RCEDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], ''))
),
'##RBH##', coalesce(outputs('Get_item_18')?['body']?['RBH']?['DisplayName'], '')
),
'##RBHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[0], ''))
),
'##RBHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RBHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['RBHComments'], '##Timestamp:')?[1], ''))
),
'##BECH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
),
'##BECHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], ''))
),
'##BECHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '',
coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], ''))
)




<div class='Page2'>
    <h3>Approval Summary</h3>
    <table cellpadding='0' cellspacing='0'>
        <tbody>
            <tr>
                <th>Role</th>
                <th>User</th>
                <th>Comments</th>
                <th>Date & Time (SGT)</th>
            </tr>" & If(
            Rectangle7_46.Visible,
            "<tr>
                <td>" & TextInput1_176.Text & "</td>
                <td>" & If(
                    IsBlank(TextInput1_177.Text),
                    Text("##CSM##"),
                    TextInput1_177.Text
                    )
                    //TextInput1_177.Text
                    & "</td>
                <td>" & If(
                    IsBlank(TextInput1_177.Text),
                    Text("##CSMComments##"),
                    TextInput1_177.Text
                    )
                    //TextInput1_178.Text
                    & "</td>
                <td>" & If(
                    IsBlank(TextInput1_177.Text),
                    Text("##CSMTimestamp##"),
                    TextInput1_177.Text
                    )
                    //TextInput1_179.Text
                    & "</td>
            </tr>",
            ""
            ) & If(
            Rectangle7_95.Visible,
            "<tr>
                <td>" & TextInput1_372.Text & "</td>
                <td>" & If(
                    IsBlank(TextInput1_373.Text),
                    Text("##RCED##"),
                    TextInput1_373.Text
                    )
                    //TextInput1_373.Text
                    & "</td>
                <td>" & If(
                    IsBlank(TextInput1_374.Text),
                    Text("##RCEDComments##"),
                    TextInput1_374.Text
                    )
                    //TextInput1_374.Text
                    & "</td>
                <td>" & If(
                    IsBlank(TextInput1_375.Text),
                    Text("##RCEDTimeStamp##"),
                    TextInput1_375.Text
                    )
                    //TextInput1_375.Text
                    & "</td>
            </tr>",
            ""
            ) & If(
            Rectangle7_49.Visible,
            "<tr>
                <td>" & TextInput1_188.Text & "</td>
                <td>" & If(
                    IsBlank(TextInput1_189.Text),
                    Text("##RFD##"),
                    TextInput1_189.Text
                    )
                    //TextInput1_189.Text
                    & "</td>
                <td>" & If(
                    IsBlank(TextInput1_190.Text),
                    Text("##RFDComments##"),
                    TextInput1_190.Text
                    )
                    //TextInput1_190.Text
                    & "</td>
                <td>" & If(
                    IsBlank(TextInput1_191.Text),
                    Text("##RFDTimestamp##"),
                    TextInput1_191.Text
                    )
                    //TextInput1_191.Text
                    & "</td>
            </tr>",
            ""
            ) & If(
            Rectangle7_92.Visible,
            "<tr>
                <td>" & TextInput1_360.Text & "</td>
                <td>" & If(
                    IsBlank(TextInput1_361.Text),
                    Text("##RBH##"),
                    TextInput1_191.Text
                    )
                    //TextInput1_361.Text
                    & "</td>
                <td>" &
                    //TextInput1_362.Text
                    If(
                    IsBlank(TextInput1_362.Text),
                    Text("##RBHComments##"),
                    TextInput1_362.Text
                    ) & "</td>
                <td>" &
                    //TextInput1_363.Text
                    If(
                    IsBlank(TextInput1_363.Text),
                    Text("##RBHTimestamp##"),
                    TextInput1_363.Text
                    ) & "</td>
            </tr>",
            ""
            ) & If(
            Rectangle7_94.Visible,
            "<tr>
                <td>" & TextInput1_368.Text & "</td>
                <td>" & If(
                    IsBlank(TextInput1_369.Text),
                    Text("##BCEH##"),
                    TextInput1_369.Text
                    ) & "</td>
                <td>" & If(
                    IsBlank(TextInput1_370.Text),
                    Text("##BCEHComments##"),
                    TextInput1_370.Text
                    ) & "</td>
                <td>" & If(
                    IsBlank(TextInput1_371.Text),
                    Text("##BCEHTimestamp##"),
                    TextInput1_371.Text
                    ) & "</td>
            </tr>",
            ""
            ) & If(
            SOGrp_POR.Visible,
            "<tr>
                <td>" & TextInput1_364.Text & "</td>
                <td>" & TextInput1_365.Text & "</td>
                <td>" & TextInput1_366.Text & "</td>
                <td>" & TextInput1_367.Text & "</td>
            </tr>",
            ""
            ) & "
        </tbody>
    </table>
</div>



replace(
replace(
replace(
replace(
replace(
replace(
outputs('Rejected_Email_Template')?['body/EmailBody'],
'##Requestor##',
outputs('RequestorName')
),
'##FormName##',
variables('FormName')
),
'##DateInitiated##',
formatDateTime(triggerOutputs()?['body/RequestDate'], 'dd-MMM-yyyy')
),
'##RejectedBy##',
triggerOutputs()?['body/Editor/DisplayName']
),
'##DateRejected##',
formatDateTime(utcNow(), 'dd-MMM-yyyy')
),
'##RejectedComments##',
if(equals(triggerOutputs()?['body/SOComments'], ''), 'N/A', split(triggerOutputs()?['body/SOComments'],
'##Timestamp:')[0])
)



concat('i:0#.f|membership|', variables('CS_Emails'))


"
<!DOCTYPE html>
<html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        .overflowtable {
            overflow-x: scroll;
        }

        .overflowtable th,
        .overflowtable td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 0px;
            white-space: break-spaces;
            font-size: small;
        }

        .Page1,
        .Page2 {
            height: auto;
        }
    </style>
</head>

<body style='font-family: Arial'>

    <div class='Page1'>

        <h1>CX Workflow</h1><br />
        <div>
            <h3>Form Name: Price Override</h3>
        </div>

        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>"& PORRequestIdInput.Text &"</td>
                    <td><b>Status: </b></td>
                    <td>"& SLCIStatusInput_1.Selected.Value &"</td>

                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>" & PORRequestorInput_1.Text & "</td>
                    <td><b>Request Date: </b></td>
                    <td>" & Text(PORDateInput_1.SelectedDate, "dd-mmm-yyyy", "en") & "</td>
                </tr>
                <tr>
                    <td><b>Sold-to Number: </b></td>
                    <td>" & POR_CustomerAccNoInput.Text & "</td>
                    <td><b>Sold-to Name: </b></td>
                    <td>" & POR_CustomerNameInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Requestor Country: </b></td>
                    <td>" & POR_CountryInput.Selected.Result & "</td>
                    <td><b>Local Currency: </b></td>
                    <td>" & POR_CurrencyInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Platform: </b></td>
                    <td>" & PORPlatform.Selected.Title & "</td>
                    <td><b>Equipment Serial Number: </b></td>
                    <td>" & POR_EquipmentSerialNoInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Contract Start Date: </b></td>
                    <td>" & Text(POR_StartDate.SelectedDate, "dd-mmm-yyyy") & "</td>
                    <td><b>Contract End Date: </b></td>
                    <td>" & Text(POR_EndDate.SelectedDate, "dd-mmm-yyyy") & "</td>
                </tr>
                <tr>
                    <td><b>Contract Number: </b></td>
                    <td>" & POR_contactNoInput.Text & "</td>
                    <td><b>Sap Document No:</b></td>
                    <td>" & PODocumentNoInput.Text &"</td>
                </tr>
                <tr>
                    <td><b>Work Order Date: </b></td>
                    <td>" & Text(POR_NotificationDate.SelectedDate, "dd-mmm-yyyy") & "</td>
                    <td><b>Work Order Number: </b></td>
                    <td>" & POR_ServiceNotificationNO.Text & "</td>

                </tr>
                <tr>
                    <td><b>Total Price Change(Tier %): </b></td>
                    <td>" & POR_TotalPriceChangeInput.Text & "</td>
                    <td><b>Department of Requestor: </b></td>
                    <td>" & Department_POR.Selected.Result & "</td>
                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>" & POApproverCommentInput.Text & "</td>
                    <td><b>Remarks: </b></td>
                    <td>" & PORRemarks.Text & "</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class='Page1' style='margin-top: 20px;'>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Product Code</th>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Reason Codes</th>
                    <th>Quantity</th>
                    <th>SAP Unit Sell Price</th>
                    <th>New Unit Sell Price</th>
                    <th>Price Change (%)</th>
                </tr>"
                & Concat(MaterialItem_SPA.AllItems, "
                <tr>
                    <td>" & ThisRecord.SPAProductCode.Selected.ProductCode & "</td>
                    <td>" /*& ThisRecord.SPAProductDesc.Text & */& ThisRecord.MaterialDrp.Selected.MaterialName &"</td>
                    <td>" & ThisRecord.SPAListedPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReasonCode.Selected.ReasonCodeName & "</td>
                    <td>" & ThisRecord.PORQuantity.Text & "</td>
                    <td>" & ThisRecord.SPAExistSellPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReqSpecialPrice.Text & "</td>
                    <td>" & ThisRecord.SPAPercentDiscount.Text & "</td>
                </tr>") &
                "
            </tbody>
        </table>
    </div>

    <div class='Page2'>
        <h3>Approval Summary</h3>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Role</th>
                    <th>User</th>
                    <th>Comments</th>
                    <th>Date & Time (SGT)</th>
                </tr>" &
                If(Rectangle7_46.Visible,
                "<tr>
                    <td>" & TextInput1_176.Text & "</td>
                    <td>" & TextInput1_177.Text & "</td>
                    <td>" & TextInput1_178.Text & "</td>
                    <td>" & TextInput1_179.Text & "</td>
                </tr>", "") &
                If(Rectangle7_95.Visible,
                "<tr>
                    <td>" & TextInput1_372.Text & "</td>
                    <td>" & TextInput1_373.Text & "</td>
                    <td>" & TextInput1_374.Text & "</td>
                    <td>" & TextInput1_375.Text & "</td>
                </tr>", "") &
                If(Rectangle7_49.Visible,
                "<tr>
                    <td>" & TextInput1_188.Text & "</td>
                    <td>" & TextInput1_189.Text & "</td>
                    <td>" & TextInput1_190.Text & "</td>
                    <td>" & TextInput1_191.Text & "</td>
                </tr>", "") &
                If(Rectangle7_92.Visible,
                "<tr>
                    <td>" & TextInput1_360.Text & "</td>
                    <td>" & TextInput1_361.Text & "</td>
                    <td>" & TextInput1_362.Text & "</td>
                    <td>" & TextInput1_363.Text & "</td>
                </tr>", "") &
                If(Rectangle7_94.Visible,
                "<tr>
                    <td>" & TextInput1_368.Text & "</td>
                    <td>" & TextInput1_369.Text & "</td>
                    <td>" & TextInput1_370.Text & "</td>
                    <td>" & TextInput1_371.Text & "</td>
                </tr>", "") &

                If(SOGrp_POR.Visible,
                "<tr>
                    <td>" & TextInput1_364.Text & "</td>
                    <td>" & TextInput1_365.Text & "</td>
                    <td>" & TextInput1_366.Text & "</td>
                    <td>" & TextInput1_367.Text & "</td>
                </tr>", "") &
                "
            </tbody>
        </table>
    </div>
</body>

</html>"


"
<!DOCTYPE html>
<html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        .overflowtable {
            overflow-x: scroll;
        }

        .overflowtable th,
        .overflowtable td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 0px;
            white-space: break-spaces;
            font-size: small;
        }

        .Page1,
        .Page2 {
            height: auto;
        }
    </style>
</head>

<body style='font-family: Arial'>

    <div class='Page1'>

        <h1>CX Workflow</h1><br />
        <p>POR_SAP2</p>

        <div>
            <h3>Form Name: Price Override</h3>
        </div>

        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>" & PORRequestIdInput.Text & "</td>
                    <td><b>Status: </b></td>
                    <td>"& LookUp(Statuses,StatusKey="Closed").Status &"</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>" & PORRequestorInput_1.Text & "</td>
                    <td><b>Request Date: </b></td>
                    <td>" & Text(PORDateInput_1.SelectedDate, "dd-mmm-yyyy", "en") & "</td>
                </tr>
                <tr>
                    <td><b>Sold-to Number: </b></td>
                    <td>" & POR_CustomerAccNoInput.Text & "</td>
                    <td><b>Sold-to Name: </b></td>
                    <td>" & POR_CustomerNameInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Requestor Country: </b></td>
                    <td>" & POR_CountryInput.Selected.Result & "</td>
                    <td><b>Local Currency: </b></td>
                    <td>" & POR_CurrencyInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Platform: </b></td>
                    <td>" & PORPlatform.Selected.Title & "</td>
                    <td><b>Equipment Serial Number: </b></td>
                    <td>" & POR_EquipmentSerialNoInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Contract Start Date: </b></td>
                    <td>" & Text(POR_StartDate.SelectedDate, "dd-mmm-yyyy") & "</td>
                    <td><b>Contract End Date: </b></td>
                    <td>" & Text(POR_EndDate.SelectedDate, "dd-mmm-yyyy") & "</td>
                </tr>
                <tr>
                    <td><b>Contract Number: </b></td>
                    <td>" & POR_contactNoInput.Text & "</td>
                    <td><b>Sap Document No:</b></td>
                    <td>" & PODocumentNoInput.Text &"</td>
                </tr>
                <tr>
                    <td><b>Work Order Date: </b></td>
                    <td>" & Text(POR_NotificationDate.SelectedDate, "dd-mmm-yyyy") & "</td>
                    <td><b>Work Order Number: </b></td>
                    <td>" & POR_ServiceNotificationNO.Text & "</td>

                </tr>
                <tr>
                    <td><b>Total Price Change(Tier %): </b></td>
                    <td>" & POR_TotalPriceChangeInput.Text & "</td>
                    <td><b>Department of Requestor: </b></td>
                    <td>" & Department_POR.Selected.Result & "</td>
                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>" & POApproverCommentInput.Text & "</td>
                    <td><b>Remarks: </b></td>
                    <td>" & PORRemarks.Text & "</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class='Page1' style='margin-top: 20px;'>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Product Code</th>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Reason Codes</th>
                    <th>Quantity</th>
                    <th>SAP Unit Sell Price</th>
                    <th>New Unit Sell Price</th>
                    <th>Price Change (%)</th>
                </tr>"
                & Concat(MaterialItem_SPA.AllItems, "
                <tr>
                    <td>" & ThisRecord.SPAProductCode.Selected.ProductCode & "</td>
                    <td>" /*& ThisRecord.SPAProductDesc.Text & */& ThisRecord.MaterialDrp.Selected.MaterialName &"</td>
                    <td>" & ThisRecord.SPAListedPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReasonCode.Selected.ReasonCodeName & "</td>
                    <td>" & ThisRecord.PORQuantity.Text & "</td>
                    <td>" & ThisRecord.SPAExistSellPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReqSpecialPrice.Text & "</td>
                    <td>" & ThisRecord.SPAPercentDiscount.Text & "</td>
                </tr>") &
                "
            </tbody>
        </table>
    </div>

    <div class='Page2'>
        <h3>Approval Summary</h3>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Role</th>
                    <th>User</th>
                    <th>Comments</th>
                    <th>Date & Time (SGT)</th>
                </tr>" &
                If(Rectangle7_46.Visible,
                "<tr>
                    <td>" & TextInput1_176.Text & "</td>
                    <td>" & TextInput1_177.Text & "</td>
                    <td>" & TextInput1_178.Text & "</td>
                    <td>" & TextInput1_179.Text & "</td>
                </tr>", "") &
                If(Rectangle7_95.Visible,
                "<tr>
                    <td>" & TextInput1_372.Text & "</td>
                    <td>" & TextInput1_373.Text & "</td>
                    <td>" & TextInput1_374.Text & "</td>
                    <td>" & TextInput1_375.Text & "</td>
                </tr>", "") &
                If(Rectangle7_49.Visible,
                "<tr>
                    <td>" & TextInput1_188.Text & "</td>
                    <td>" & TextInput1_189.Text & "</td>
                    <td>" & TextInput1_190.Text & "</td>
                    <td>" & TextInput1_191.Text & "</td>
                </tr>", "")
                &
                If(Rectangle7_92.Visible,
                "<tr>
                    <td>" & TextInput1_360.Text & "</td>
                    <td>" & TextInput1_361.Text & "</td>
                    <td>" & TextInput1_362.Text & "</td>
                    <td>" & TextInput1_363.Text & "</td>
                </tr>", "") &
                If(Rectangle7_94.Visible,
                "<tr>
                    <td>" & TextInput1_368.Text & "</td>
                    <td>" & TextInput1_369.Text & "</td>
                    <td>" & TextInput1_370.Text & "</td>
                    <td>" & TextInput1_371.Text & "</td>
                </tr>", "") &
                If(Rectangle7_50.Visible,
                "<tr>
                    <td>" & TextInput1_192.Text & "</td>
                    <td>" & TextInput1_193.Text & "</td>
                    <td>" & TextInput1_194.Text & "</td>
                    <td>" & TextInput1_195.Text & "</td>
                </tr>", "") &
                If(SOGrp_POR.Visible,
                "<tr>
                    <td>" & TextInput1_364.Text & "</td>
                    <td>" & Office365Users.MyProfileV2().displayName & "</td>
                    <td>" & POR_SOCommentInput.Text & "</td>
                    <td>" & Text(
                        DateAdd(
                        DateAdd(
                        Now(),
                        TimeZoneOffset(),
                        TimeUnit.Minutes
                        ),
                        8,
                        TimeUnit.Hours
                        ),
                        "dd-mmm-yyyy hh:mm:ss AM/PM"
                        ) & "</td>
                </tr>", "") &
                "
            </tbody>
        </table>
    </div>


</body>

</html>"


"
<!DOCTYPE html>
<html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        .overflowtable {
            overflow-x: scroll;
        }

        .overflowtable th,
        .overflowtable td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 0px;
            white-space: break-spaces;
            font-size: small;
        }

        .Page1,
        .Page2 {
            height: auto;
        }
    </style>
</head>

<body style='font-family: Arial'>

    <div class='Page1'>

        <h1>CX Workflow</h1><br />

        <div>
            <h3>Form Name: Price Override</h3>
        </div>
        <p>POR_SAP3</p>

        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>" & PORRequestIdInput.Text & "</td>
                    <td><b>Status: </b></td>
                    <td>" & LookUp(
                        Statuses,
                        StatusKey = "Rejected"
                        ).Status & "</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>" & PORRequestorInput_1.Text & "</td>
                    <td><b>Request Date: </b></td>
                    <td>" & Text(
                        PORDateInput_1.SelectedDate,
                        "dd-mmm-yyyy",
                        "en"
                        ) & "</td>
                </tr>
                <tr>
                    <td><b>Sold-to Number: </b></td>
                    <td>" & POR_CustomerAccNoInput.Text & "</td>
                    <td><b>Sold-to Name: </b></td>
                    <td>" & POR_CustomerNameInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Requestor Country: </b></td>
                    <td>" & POR_CountryInput.Selected.Result & "</td>
                    <td><b>Local Currency: </b></td>
                    <td>" & POR_CurrencyInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Platform: </b></td>
                    <td>" & PORPlatform.Selected.Title & "</td>
                    <td><b>Equipment Serial Number: </b></td>
                    <td>" & POR_EquipmentSerialNoInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Contract Start Date: </b></td>
                    <td>" & Text(
                        POR_StartDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                    <td><b>Contract End Date: </b></td>
                    <td>" & Text(
                        POR_EndDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                </tr>
                <tr>
                    <td><b>Contract Number: </b></td>
                    <td>" & POR_contactNoInput.Text & "</td>
                    <td><b>Sap Document No:</b></td>
                    <td>" & PODocumentNoInput.Text &"</td>
                </tr>
                <tr>
                    <td><b>Work Order Date: </b></td>
                    <td>" & Text(POR_NotificationDate.SelectedDate, "dd-mmm-yyyy") & "</td>
                    <td><b>Work Order Number: </b></td>
                    <td>" & POR_ServiceNotificationNO.Text & "</td>

                </tr>
                <tr>
                    <td><b>Total Price Change(Tier %): </b></td>
                    <td>" & POR_TotalPriceChangeInput.Text & "</td>
                    <td><b>Department of Requestor: </b></td>
                    <td>" & Department_POR.Selected.Result & "</td>
                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>" & POApproverCommentInput.Text & "</td>
                    <td><b>Remarks: </b></td>
                    <td>" & PORRemarks.Text & "</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class='Page1' style='margin-top: 20px;'>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Product Code</th>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Reason Codes</th>
                    <th>Quantity</th>
                    <th>SAP Unit Sell Price</th>
                    <th>New Unit Sell Price</th>
                    <th>Price Change (%)</th>
                </tr>" & Concat(
                MaterialItem_SPA.AllItems,
                "
                <tr>
                    <td>" & ThisRecord.SPAProductCode.Selected.ProductCode & "</td>
                    <td>" /*& ThisRecord.SPAProductDesc.Text & */& ThisRecord.MaterialDrp.Selected.MaterialName &"</td>
                    <td>" & ThisRecord.SPAListedPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReasonCode.Selected.ReasonCodeName & "</td>
                    <td>" & ThisRecord.PORQuantity.Text & "</td>
                    <td>" & ThisRecord.SPAExistSellPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReqSpecialPrice.Text & "</td>
                    <td>" & ThisRecord.SPAPercentDiscount.Text & "</td>
                </tr>"
                ) & "
            </tbody>
        </table>
    </div>

    <div class='Page2'>
        <h3>Approval Summary</h3>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Role</th>
                    <th>User</th>
                    <th>Comments</th>
                    <th>Date & Time (SGT)</th>
                </tr>" & If(
                Rectangle7_46.Visible,
                "<tr>
                    <td>" & TextInput1_176.Text & "</td>
                    <td>" & TextInput1_177.Text & "</td>
                    <td>" & TextInput1_178.Text & "</td>
                    <td>" & TextInput1_179.Text & "</td>
                </tr>",
                ""
                ) &
                If(Rectangle7_95.Visible,
                "<tr>
                    <td>" & TextInput1_372.Text & "</td>
                    <td>" & TextInput1_373.Text & "</td>
                    <td>" & TextInput1_374.Text & "</td>
                    <td>" & TextInput1_375.Text & "</td>
                </tr>", "") &
                If(
                Rectangle7_49.Visible,
                "<tr>
                    <td>" & TextInput1_188.Text & "</td>
                    <td>" & TextInput1_189.Text & "</td>
                    <td>" & TextInput1_190.Text & "</td>
                    <td>" & TextInput1_191.Text & "</td>
                </tr>",
                ""
                ) &
                If(
                Rectangle7_92.Visible,
                "<tr>
                    <td>" & TextInput1_360.Text & "</td>
                    <td>" & TextInput1_361.Text & "</td>
                    <td>" & TextInput1_362.Text & "</td>
                    <td>" & TextInput1_363.Text & "</td>
                </tr>",
                ""
                ) &
                If(Rectangle7_94.Visible,
                "<tr>
                    <td>" & TextInput1_368.Text & "</td>
                    <td>" & TextInput1_369.Text & "</td>
                    <td>" & TextInput1_370.Text & "</td>
                    <td>" & TextInput1_371.Text & "</td>
                </tr>", "") &
                If(
                Rectangle7_50.Visible,
                "<tr>
                    <td>" & TextInput1_192.Text & "</td>
                    <td>" & TextInput1_193.Text & "</td>
                    <td>" & TextInput1_194.Text & "</td>
                    <td>" & TextInput1_195.Text & "</td>
                </tr>",
                ""
                ) & If(
                SOGrp_POR.Visible,
                "<tr>
                    <td>" & TextInput1_364.Text & "</td>
                    <td>" & Office365Users.MyProfileV2().displayName & "</td>
                    <td>" & POR_SOCommentInput.Text & "</td>
                    <td>" & Text(
                        DateAdd(
                        DateAdd(
                        Now(),
                        TimeZoneOffset(),
                        TimeUnit.Minutes
                        ),
                        8,
                        TimeUnit.Hours
                        ),
                        "dd-mmm-yyyy hh:mm:ss AM/PM"
                        ) & "</td>
                </tr>",
                ""
                ) & "
            </tbody>
        </table>
    </div>

</body>

</html>"



///SAP_3

"
<!DOCTYPE html>
<html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        .overflowtable {
            overflow-x: scroll;
        }

        .overflowtable th,
        .overflowtable td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 0px;
            white-space: break-spaces;
            font-size: small;
        }

        .Page1,
        .Page2 {
            height: auto;
        }
    </style>
</head>

<body style='font-family: Arial'>

    <div class='Page1'>

        <h1>CX Workflow</h1><br />

        <div>
            <h3>Form Name: Price Override</h3>
        </div>
        <p>POR_SAP3</p>

        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>" & PORRequestIdInput.Text & "</td>
                    <td><b>Status: </b></td>
                    <td>" & LookUp(
                        Statuses,
                        StatusKey = "Rejected"
                        ).Status & "</td>
                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>" & PORRequestorInput_1.Text & "</td>
                    <td><b>Request Date: </b></td>
                    <td>" & Text(
                        PORDateInput_1.SelectedDate,
                        "dd-mmm-yyyy",
                        "en"
                        ) & "</td>
                </tr>
                <tr>
                    <td><b>Sold-to Number: </b></td>
                    <td>" & POR_CustomerAccNoInput.Text & "</td>
                    <td><b>Sold-to Name: </b></td>
                    <td>" & POR_CustomerNameInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Requestor Country: </b></td>
                    <td>" & POR_CountryInput.Selected.Result & "</td>
                    <td><b>Local Currency: </b></td>
                    <td>" & POR_CurrencyInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Platform: </b></td>
                    <td>" & PORPlatform.Selected.Title & "</td>
                    <td><b>Equipment Serial Number: </b></td>
                    <td>" & POR_EquipmentSerialNoInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Contract Start Date: </b></td>
                    <td>" & Text(
                        POR_StartDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                    <td><b>Contract End Date: </b></td>
                    <td>" & Text(
                        POR_EndDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                </tr>
                <tr>
                    <td><b>Contract Number: </b></td>
                    <td>" & POR_contactNoInput.Text & "</td>
                    <td><b>Sap Document No:</b></td>
                    <td>" & PODocumentNoInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Work Order Date: </b></td>
                    <td>" & Text(
                        POR_NotificationDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                    <td><b>Work Order Number: </b></td>
                    <td>" & POR_ServiceNotificationNO.Text & "</td>

                </tr>
                <tr>
                    <td><b>Total Price Change(Tier %): </b></td>
                    <td>" & POR_TotalPriceChangeInput.Text & "</td>
                    <td><b>Department:</b></td>
                    <td>" & & "</td>
                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>" & POApproverCommentInput.Text & "</td>
                    <td><b>Remarks: </b></td>
                    <td>" & PORRemarks.Text & "</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class='Page1' style='margin-top: 20px;'>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Product Code</th>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Reason Codes</th>
                    <th>Quantity</th>
                    <th>SAP Unit Sell Price</th>
                    <th>New Unit Sell Price</th>
                    <th>Price Change (%)</th>
                </tr>" & Concat(
                MaterialItem_SPA.AllItems,
                "
                <tr>
                    <td>" & ThisRecord.SPAProductCode.Selected.ProductCode & "</td>
                    <td>" /*& ThisRecord.SPAProductDesc.Text & */& ThisRecord.MaterialDrp.Selected.MaterialName & "</td>
                    <td>" & ThisRecord.SPAListedPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReasonCode.Selected.ReasonCodeName & "</td>
                    <td>" & ThisRecord.PORQuantity.Text & "</td>
                    <td>" & ThisRecord.SPAExistSellPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReqSpecialPrice.Text & "</td>
                    <td>" & ThisRecord.SPAPercentDiscount.Text & "</td>
                </tr>"
                ) & "
            </tbody>
        </table>
    </div>

    <div class='Page2'>
        <h3>Approval Summary</h3>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Role</th>
                    <th>User</th>
                    <th>Comments</th>
                    <th>Date & Time (SGT)</th>
                </tr>" & If(
                Rectangle7_46.Visible,
                "<tr>
                    <td>" & TextInput1_176.Text & "</td>
                    <td>" & TextInput1_177.Text & "</td>
                    <td>" & TextInput1_178.Text & "</td>
                    <td>" & TextInput1_179.Text & "</td>
                </tr>",
                ""
                ) & If(
                Rectangle7_95.Visible,
                "<tr>
                    <td>" & TextInput1_372.Text & "</td>
                    <td>" & TextInput1_373.Text & "</td>
                    <td>" & TextInput1_374.Text & "</td>
                    <td>" & TextInput1_375.Text & "</td>
                </tr>",
                ""
                ) & If(
                Rectangle7_49.Visible,
                "<tr>
                    <td>" & TextInput1_188.Text & "</td>
                    <td>" & TextInput1_189.Text & "</td>
                    <td>" & TextInput1_190.Text & "</td>
                    <td>" & TextInput1_191.Text & "</td>
                </tr>",
                ""
                ) & If(
                Rectangle7_92.Visible,
                "<tr>
                    <td>" & TextInput1_360.Text & "</td>
                    <td>" & TextInput1_361.Text & "</td>
                    <td>" & TextInput1_362.Text & "</td>
                    <td>" & TextInput1_363.Text & "</td>
                </tr>",
                ""
                ) & If(
                Rectangle7_94.Visible,
                "<tr>
                    <td>" & TextInput1_368.Text & "</td>
                    <td>" & TextInput1_369.Text & "</td>
                    <td>" & TextInput1_370.Text & "</td>
                    <td>" & TextInput1_371.Text & "</td>
                </tr>",
                ""
                ) & If(
                Rectangle7_50.Visible,
                "<tr>
                    <td>" & TextInput1_192.Text & "</td>
                    <td>" & TextInput1_193.Text & "</td>
                    <td>" & TextInput1_194.Text & "</td>
                    <td>" & TextInput1_195.Text & "</td>
                </tr>",
                ""
                ) & If(
                SOGrp_POR.Visible,
                "<tr>
                    <td>" & TextInput1_364.Text & "</td>
                    <td>" & Office365Users.MyProfileV2().displayName & "</td>
                    <td>" & POR_SOCommentInput.Text & "</td>
                    <td>" & Text(
                        DateAdd(
                        DateAdd(
                        Now(),
                        TimeZoneOffset(),
                        TimeUnit.Minutes
                        ),
                        8,
                        TimeUnit.Hours
                        ),
                        "dd-mmm-yyyy hh:mm:ss AM/PM"
                        ) & "</td>
                </tr>",
                ""
                ) & "
            </tbody>
        </table>
    </div>

</body>

</html>"




"
<!DOCTYPE html>
<html>

<head>
    <style>
        h1 {
            color: black;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        .overflowtable {
            overflow-x: scroll;
        }

        .overflowtable th,
        .overflowtable td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 0px;
            white-space: break-spaces;
            font-size: small;
        }

        .Page1,
        .Page2 {
            height: auto;
        }
    </style>
</head>

<body style='font-family: Arial'>
    <div class='Page1'>
        <h1>CX Workflow</h1><br />
        <p>Testss</p>
        <div>
            <h3>Form Name: Price Override</h3>
        </div>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <td><b>Request ID: </b></td>
                    <td>" & "##RequestID##" & "</td>
                    <td><b>Status: </b></td>
                    <td>" & LookUp(
                        Statuses,
                        StatusKey = "ActionRequiredSO"
                        ).Status & "</td>

                </tr>
                <tr>
                    <td><b>Requestor: </b></td>
                    <td>" & PORRequestorInput_1.Text & "</td>
                    <td><b>Request Date: </b></td>
                    <td>" & Text(
                        PORDateInput_1.SelectedDate,
                        "dd-mmm-yyyy",
                        "en"
                        ) & "</td>
                </tr>
                <tr>
                    <td><b>Sold-to Number: </b></td>
                    <td>" & POR_CustomerAccNoInput.Text & "</td>
                    <td><b>Sold-to Name: </b></td>
                    <td>" & POR_CustomerNameInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Requestor Country: </b></td>
                    <td>" & POR_CountryInput.Selected.Result & "</td>
                    <td><b>Local Currency: </b></td>
                    <td>" & POR_CurrencyInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Platform: </b></td>
                    <td>" & PORPlatform.Selected.Title & "</td>
                    <td><b>Equipment Serial Number: </b></td>
                    <td>" & POR_EquipmentSerialNoInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Contract Start Date: </b></td>
                    <td>" & Text(
                        POR_StartDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                    <td><b>Contract End Date: </b></td>
                    <td>" & Text(
                        POR_EndDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                </tr>
                <tr>
                    <td><b>Contract Number: </b></td>
                    <td>" & POR_contactNoInput.Text & "</td>
                    <td><b>Sap Document No:</b></td>
                    <td>" & PODocumentNoInput.Text & "</td>
                </tr>
                <tr>
                    <td><b>Work Order Date: </b></td>
                    <td>" & Text(
                        POR_NotificationDate.SelectedDate,
                        "dd-mmm-yyyy"
                        ) & "</td>
                    <td><b>Work Order Number: </b></td>
                    <td>" & POR_ServiceNotificationNO.Text & "</td>

                </tr>
                <tr>
                    <td><b>Total Price Change(Tier %): </b></td>
                    <td>" & POR_TotalPriceChangeInput.Text & "</td>
                    <td><b>Department:</b></td>
                    <td>" & Department_POR.Selected.Result & "</td>
                </tr>
                <tr>
                    <td><b>Approval Comments: </b></td>
                    <td>" & POApproverCommentInput.Text & "</td>
                    <td><b>Remarks: </b></td>
                    <td>" & PORRemarks.Text & "</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class='Page1' style='margin-top: 20px;'>
        <table cellpadding='0' cellspacing='0'>
            <tbody>
                <tr>
                    <th>Product Code</th>
                    <th>Material</th>
                    <th>Material Description</th>
                    <th>Reason Codes</th>
                    <th>Quantity</th>
                    <th>SAP Unit Sell Price</th>
                    <th>New Unit Sell Price</th>
                    <th>Price Change (%)</th>
                </tr>" & Concat(
                MaterialItem_SPA.AllItems,
                "
                <tr>
                    <td>" & ThisRecord.SPAProductCode.Selected.ProductCode & "</td>
                    <td>" /*& ThisRecord.SPAProductDesc.Text & */& ThisRecord.MaterialDrp.Selected.MaterialName & "</td>
                    <td>" & ThisRecord.SPAListedPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReasonCode.Selected.ReasonCodeName & "</td>
                    <td>" & ThisRecord.PORQuantity.Text & "</td>
                    <td>" & ThisRecord.SPAExistSellPrice.Text & "</td>
                    <td>" & ThisRecord.SPAReqSpecialPrice.Text & "</td>
                    <td>" & ThisRecord.SPAPercentDiscount.Text & "</td>
                </tr>"
                ) & "
            </tbody>
        </table>
    </div>
</body>

</html>"



{
    "Claims": "@{concat('i:0#.f|membership|', string(variables('Approver2')))}"
  }


  "@{string(variables('Approver2'))}"




  replace(
    replace(
        replace(
            replace(
                replace(
                    replace(
						replace(
							replace(
								replace(
									replace(
										replace(
											replace(
												replace(
													replace(
														replace(
															replace(
																replace(
																	replace(
                        coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
                        '##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
                    ),
                    '##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
                ),
                '##Logo##', coalesce(variables('PDF Logo'), '')
            ),
            '##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
        ),
        '##CSMComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], ''))
    ),
    '##CSMTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], ''))
	),
	'##RCOH##', coalesce(outputs('Get_item_18')?['body']?['RCOH']?['DisplayName'], '')
        ),
        '##RCOHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[0], ''))
    ),
    '##RCOHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[1], ''))
	),
	'##RCXD##', coalesce(outputs('Get_item_18')?['body']?['RCXD'], '')
        ),
        '##RCXDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], ''))
    ),
    '##RCXDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], ''))
	),
	'##GCXH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
        ),
        '##GCXHComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], ''))
    ),
    '##GCXHTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], ''))
	),
	'##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
        ),
        '##RFDComments##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], ''))
    ),
    '##RFDTimestamp##', if(equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), '', coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], ''))
	)






    {
        "@odata.etag": "\"17\"",
        "ItemInternalId": "166",
        "ID": 166,
        "SpecialPricingDate": "2024-12-20",
        "LocalCurrency": "JPY",
        "CustomerAccountNumber": "324324",
        "CustomerName": "sdfdfdsf",
        "RequestID": "POR-20Dec2024-00166",
        "ApprovalComments": "\r\nRFD :RFD\nGCXH :GCXH\\nRBH :RCXD SO:",
        "Status": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
          "Id": 14,
          "Value": "Fully Approved (Pending with SO)"
        },
        "Status#Id": 14,
        "WorkFlowPendingWith": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
          "Id": -1,
          "Value": "SO"
        },
        "WorkFlowPendingWith#Id": -1,
        "Requestor": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
          "Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
          "DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
          "Email": "PBiswa27@ITS.JNJ.com",
          "Picture": "https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
          "Department": "ITS Program Support"
        },
        "Requestor#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
        "Modified": "2024-12-20T11:21:54Z",
        "RFD": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
          "Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
          "DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
          "Email": "PBiswa27@ITS.JNJ.com",
          "Picture": "https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
          "Department": "ITS Program Support",
          "JobTitle": null
        },
        "RFD#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
        "SaveAsPdfContent": "<!DOCTYPE html>\n<html>\n<head>\n    <style>\n        h1 { color: black; }\n        td, th {\n            border: 1px solid #dddddd;\n            text-align: left;\n            padding: 8px;\n        }\n        .overflowtable {\n            overflow-x: scroll;\n        }\n        .overflowtable th, .overflowtable td {\n            border: 1px solid #dddddd;\n            text-align: left;\n            padding: 0px;\n            white-space: break-spaces;\n            font-size: small;\n        }\n        .Page1, .Page2 {\n            height: auto;\n        }\n    </style>\n</head>\n<body style='font-family: Arial'>\n<div class='Page1'>\n<h1>CX Workflow</h1><br/> \n<p>Testss</p>\n<div><h3>Form Name: Price Override</h3></div>\n<table cellpadding='0' cellspacing='0'>\n\t<tbody>\n\t\t<tr><td><b>Request ID: </b></td><td>##RequestID##</td>\n<td><b>Status: </b></td><td>Fully Approved (Pending with SO)</td>\n\t\t\t\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Requestor: </b></td><td>Pritam Biswas</td>\n\t\t\t<td><b>Request Date: </b></td><td>20-Dec-2024</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Sold-to Number: </b></td><td>324324</td>\n\t\t\t<td><b>Sold-to Name: </b></td><td>sdfdfdsf</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Requestor Country: </b></td><td>JAPAN</td>\n\t\t\t<td><b>Local Currency: </b></td><td>JPY</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Platform: </b></td><td>Lipiflow</td>\n\t\t\t<td><b>Equipment Serial Number: </b></td><td>43243424</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Contract Start Date: </b></td><td></td>\n\t\t\t<td><b>Contract End Date: </b></td><td></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Contract Number: </b></td><td></td>\n\t\t\t<td><b>Work Order Date: </b></td><td></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Work Order Number: </b></td><td></td>\n\t\t\t<td><b>Total Price Change(Tier %): </b></td><td>-92.00</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><b>Remarks: </b></td><td></td>\n\t\t\t<td><b>Approval Comments: </b></td><td></td>\n\t\t</tr>\n\t\t<tr>\n\t\t</tr>\n\t</tbody>\n</table>\n</div>\n<div class='Page1' style='margin-top: 20px;'>\n    <table cellpadding='0' cellspacing='0'>\n        <tbody>\n            <tr>\n                <th>Product Code</th>\n                <th>Material</th>\n                <th>Material Description</th>\n                <th>Reason Codes</th>\n                <th>Quantity</th>\n                <th>SAP Unit Sell Price</th>\n                <th>New Unit Sell Price</th>\n                <th>Price Change (%)</th>\n            </tr>  \n            <tr>\n                <td>Value Advantage</td>\n                <td>CYS - SA</td>\n                <td>dfsfdfsf</td>\n                <td>Discount (due to commercial agreement)</td>\n                <td>120</td>\n                <td>1000</td>\n                <td>80</td>\n                <td>-92.00</td>\n            </tr></tbody>\n    </table>\n</div>\n</body>\n</html>",
        "RejectedBy": [],
        "RejectedBy@odata.type": "#Collection(Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference)",
        "RejectedBy#Id": [],
        "RejectedBy#Id@odata.type": "#Collection(Int64)",
        "RFDComments": "RFD ##Timestamp:20-Dec-2024 07:21:04 PM",
        "Platform": "Lipiflow",
        "EquipmentSerialNo": "43243424",
        "TotalPriceChange": -92,
        "Country": "JAPAN",
        "GCXH": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
          "Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
          "DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
          "Email": "PBiswa27@ITS.JNJ.com",
          "Picture": "https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
          "Department": "ITS Program Support",
          "JobTitle": null
        },
        "GCXH#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
        "GCXHComments": "GCXH ##Timestamp:20-Dec-2024 07:21:25 PM",
        "Department": "Services",
        "PreviousPrice": 1000,
        "NewPrice": 80,
        "RCXD": "PBiswa27@ITS.JNJ.com",
        "RCXDComments": "RCXD ##Timestamp:20-Dec-2024 07:21:41 PM",
        "WorkFlowTimeout": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
          "Id": 1,
          "Value": "NO"
        },
        "WorkFlowTimeout#Id": 1,
        "DateDiff": "",
        "Created": "2024-12-20T11:18:48Z",
        "Author": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
          "Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
          "DisplayName": "Biswas, Pritam [MEDJP NON-J&J]",
          "Email": "PBiswa27@ITS.JNJ.com",
          "Picture": "https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=PBiswa27@ITS.JNJ.com",
          "Department": "ITS Program Support"
        },
        "Author#Claims": "i:0#.f|membership|pbiswa27@its.jnj.com",
        "Editor": {
          "@odata.type": "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
          "Claims": "i:0#.f|membership|slim76@its.jnj.com",
          "DisplayName": "Lim, Shanan [VISAP]",
          "Email": "SLim76@ITS.JNJ.com",
          "Picture": "https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/UserPhoto.aspx?Size=L&AccountName=SLim76@ITS.JNJ.com",
          "Department": "Reg Cat OH Alloc",
          "JobTitle": "Associate Director  Customer Operations"
        },
        "Editor#Claims": "i:0#.f|membership|slim76@its.jnj.com",
        "{Identifier}": "Lists%252fPriceOverride%252f166_.000",
        "{IsFolder}": false,
        "{Thumbnail}": {
          "Large": null,
          "Medium": null,
          "Small": null
        },
        "{Link}": "https://jnj.sharepoint.com/teams/dev-CXPWorkflowPowerApps/_layouts/15/listform.aspx?PageType=4&ListId=d6e93fd0%2D7463%2D4c32%2Db79d%2Ded15724ccb39&ID=166&ContentTypeID=0x010014F648176457EF42B0CE1F63CB0CFE2E",
        "{Name}": "",
        "{FilenameWithExtension}": "",
        "{Path}": "Lists/PriceOverride/",
        "{FullPath}": "Lists/PriceOverride/166_.000",
        "{HasAttachments}": false,
        "{VersionNumber}": "17.0"
      }





      /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


      replace(
        replace(
            replace(
                replace(
                    replace(
                        replace(
                            replace(
                                replace(
                                    replace(
                                        replace(
                                            replace(
                                                replace(
                                                    replace(
                                                        replace(
                                                            replace(
                                                                replace(
                                                                    replace(
                                                                        replace(
                                                                            coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
                                                                            '##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
                                                                        ),
                                                                        '##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
                                                                    ),
                                                                    '##Logo##', coalesce(variables('PDF Logo'), '')
                                                                ),
                                                                '##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
                                                            ),
                                                            '##CSMComments##', 
                                                            if(
                                                                equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                                '', 
                                                                coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], '')
                                                            )
                                                        ),
                                                        '##CSMTimestamp##', 
                                                        if(
                                                            equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                            '', 
                                                            coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], '')
                                                        )
                                                    ),
                                                    '##RCOH##', coalesce(outputs('Get_item_18')?['body']?['RCOH']?['DisplayName'], '')
                                                ),
                                                '##RCOHComments##', 
                                                if(
                                                    equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                    '', 
                                                    coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[0], '')
                                                )
                                            ),
                                            '##RCOHTimestamp##', 
                                            if(
                                                equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                '', 
                                                coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[1], '')
                                            )
                                        ),
                                        '##RCXD##', coalesce(outputs('Get_item_18')?['body']?['RCXD'], '')
                                    ),
                                    '##RCXDComments##', 
                                    if(
                                        equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                        '', 
                                        coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], '')
                                    )
                                ),
                                '##RCXDTimestamp##', 
                                if(
                                    equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                    '', 
                                    coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], '')
                                )
                            ),
                            '##GCXH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
                        ),
                        '##GCXHComments##', 
                        if(
                            equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                            '', 
                            coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], '')
                        )
                    ),
                    '##GCXHTimestamp##', 
                    if(
                        equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                        '', 
                        coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], '')
                    )
                ),
                '##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
            ),
            '##RFDComments##', 
            if(
                equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
                '', 
                coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], '')
            )
        ),
        '##RFDTimestamp##', 
        if(
            equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
            '', 
            coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], '')
        )
    )
    

    //////////////////////////////////Price Override///////////////////////////////////////////////////////////////
    replace(
    replace(
        replace(
            replace(
                replace(
                    replace(
                        replace(
                            replace(
                                replace(
                                    replace(
                                        replace(
                                            replace(
                                                replace(
                                                    replace(
                                                        replace(
                                                            replace(
                                                                replace(
                                                                    replace(
                                                                        coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
                                                                        '##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
                                                                    ),
                                                                    '##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
                                                                ),
                                                                '##Logo##', coalesce(variables('PDF Logo'), '')
                                                            ),
                                                            '##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
                                                        ),
                                                        '##CSMComments##', 
                                                        if(
                                                            equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                            '', 
                                                            coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], '')
                                                        )
                                                    ),
                                                    '##CSMTimestamp##', 
                                                    if(
                                                        equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                        '', 
                                                        coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], '')
                                                    )
                                                ),
                                                '##RCOH##', coalesce(outputs('Get_item_18')?['body']?['RCOH']?['DisplayName'], '')
                                            ),
                                            '##RCOHComments##', 
                                            if(
                                                equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                '', 
                                                coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[0], '')
                                            )
                                        ),
                                        '##RCOHTimestamp##', 
                                        if(
                                            equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                            '', 
                                            coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[1], '')
                                        )
                                    ),
                                    '##RCXD##', coalesce(outputs('Get_item_18')?['body']?['RCXD'], '')
                                ),
                                '##RCXDComments##', 
                                if(
                                    equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                    '', 
                                    coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], '')
                                )
                            ),
                            '##RCXDTimestamp##', 
                            if(
                                equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                '', 
                                coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], '')
                            )
                        ),
                        '##GCXH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
                    ),
                    '##GCXHComments##', 
                    if(
                        equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                        '', 
                        coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], '')
                    )
                ),
                '##GCXHTimestamp##', 
                if(
                    equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                    '', 
                    coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], '')
                )
            ),
            '##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
        ),
        '##RFDComments##', 
        if(
            equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
            '', 
            coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], '')
        )
    ),
    '##RFDTimestamp##', 
    if(
        equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
        '', 
        coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], '')
    )
)



replace(
        replace(
            replace(
                replace(
                    replace(
                        replace(
                            outputs('Rejected_Email_Template')?['body/EmailBody'],
                            '##Requestor##', triggerOutputs()?['body/Requestor/DisplayName']
                        ),
                    '##FormName##', variables('FormName')
                    ),
                '##DateInitiated##', formatDateTime(triggerOutputs()?['body/SpecialPricingDate'], 'dd-MMM-yyyy')
                ),
            '##DateRejected##', formatDateTime(utcNow(), 'dd-MMM-yyyy')
            ),
        '##RejectedBy##', triggerOutputs()?['body/Editor/DisplayName']
        ),
	'##RejectedComments##', split(triggerOutputs()?['body/SOComments'], '##Timestamp:')[0]
	)





    <!DOCTYPE html>
<html>
<head>
    <style>
        h1 { color: black; }
        td, th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }
        .overflowtable {
            overflow-x: scroll;
        }
        .overflowtable th, .overflowtable td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 0px;
            white-space: break-spaces;
            font-size: small;
        }
        .Page1, .Page2 {
            height: auto;
        }
    </style>
</head>
<body style='font-family: Arial'>
<div class='Page1'>
<h1>CX Workflow</h1><br/> 
<p>Testss</p>
<div><h3>Form Name: Price Override</h3></div>
<table cellpadding='0' cellspacing='0'>
	<tbody>
		<tr><td><b>Request ID: </b></td><td>##RequestID##</td>
<td><b>Status: </b></td><td>Fully Approved (Pending with SO)</td>
			
		</tr>
		<tr>
			<td><b>Requestor: </b></td><td>Pritam Biswas</td>
			<td><b>Request Date: </b></td><td>20-Dec-2024</td>
		</tr>
		<tr>
			<td><b>Sold-to Number: </b></td><td>423</td>
			<td><b>Sold-to Name: </b></td><td>sfds</td>
		</tr>
		<tr>
			<td><b>Requestor Country: </b></td><td>JAPAN</td>
			<td><b>Local Currency: </b></td><td>JPY</td>
		</tr>
		<tr>
			<td><b>Platform: </b></td><td>Lipiflow</td>
			<td><b>Equipment Serial Number: </b></td><td>3234554</td>
		</tr>
		<tr>
			<td><b>Contract Start Date: </b></td><td></td>
			<td><b>Contract End Date: </b></td><td></td>
		</tr>
		<tr>
			<td><b>Contract Number: </b></td><td></td>
			<td><b>Work Order Date: </b></td><td></td>
		</tr>
		<tr>
			<td><b>Work Order Number: </b></td><td></td>
			<td><b>Total Price Change(Tier %): </b></td><td>-92.00</td>
		</tr>
		<tr>
			<td><b>Remarks: </b></td><td></td>
			<td><b>Approval Comments: </b></td><td></td>
		</tr>
		<tr>
		</tr>
	</tbody>
</table>
</div>
<div class='Page1' style='margin-top: 20px;'>
    <table cellpadding='0' cellspacing='0'>
        <tbody>
            <tr>
                <th>Product Code</th>
                <th>Material</th>
                <th>Material Description</th>
                <th>Reason Codes</th>
                <th>Quantity</th>
                <th>SAP Unit Sell Price</th>
                <th>New Unit Sell Price</th>
                <th>Price Change (%)</th>
            </tr>  
            <tr>
                <td>Preventative Maintenance</td>
                <td>CYS - SA</td>
                <td>rewrewrwer</td>
                <td>Discount (due to commercial agreement)</td>
                <td>120</td>
                <td>1000</td>
                <td>80</td>
                <td>-92.00</td>
            </tr></tbody>
    </table>
</div>
<div class='Page2'>
<h3>Approval Summary</h3>
<table cellpadding='0' cellspacing='0'>
<tbody>
<tr>
<th>Role</th>
<th>User</th>
<th>Comments</th>
<th>Date & Time (SGT)</th>
</tr><tr>
<td>Service Ops</td>
<td></td>
<td></td>
<td></td>
</tr></tbody>
</table>
</div>
</body>
</html>


SPAPercentDiscount


replace(
        replace(
            replace(
                replace(
                    replace(
                        replace(
                            replace(
                                replace(
                                    replace(
                                        replace(
                                            replace(
                                                replace(
                                                    replace(
                                                        replace(
                                                            replace(
                                                                replace(
                                                                    replace(
                                                                        replace(
                                                                            coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
                                                                            '##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
                                                                        ),
                                                                        '##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
                                                                    ),
                                                                    '##Logo##', coalesce(variables('PDF Logo'), '')
                                                                ),
                                                                '##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
                                                            ),
                                                            '##CSMComments##', 
                                                            if(
                                                                equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                                '', 
                                                                coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], '')
                                                            )
                                                        ),
                                                        '##CSMTimestamp##', 
                                                        if(
                                                            equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                            '', 
                                                            coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], '')
                                                        )
                                                    ),
                                                    '##RCOH##', coalesce(outputs('Get_item_18')?['body']?['RCOH']?['DisplayName'], '')
                                                ),
                                                '##RCOHComments##', 
                                                if(
                                                    equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                    '', 
                                                    coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[0], '')
                                                )
                                            ),
                                            '##RCOHTimestamp##', 
                                            if(
                                                equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                '', 
                                                coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[1], '')
                                            )
                                        ),
                                        '##RCXD##', coalesce(outputs('Get_item_18')?['body']?['RCXD'], '')
                                    ),
                                    '##RCXDComments##', 
                                    if(
                                        equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                        '', 
                                        coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], '')
                                    )
                                ),
                                '##RCXDTimestamp##', 
                                if(
                                    equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                    '', 
                                    coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], '')
                                )
                            ),
                            '##GCXH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
                        ),
                        '##GCXHComments##', 
                        if(
                            equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                            '', 
                            coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], '')
                        )
                    ),
                    '##GCXHTimestamp##', 
                    if(
                        equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                        '', 
                        coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], '')
                    )
                ),
                '##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
            ),
            '##RFDComments##', 
            if(
                equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
                '', 
                coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], '')
            )
        ),
        '##RFDTimestamp##', 
        if(
            equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
            '', 
            coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], '')
        )
    )





    replace(
        replace(
            replace(
                replace(
                    replace(
                        replace(
                            replace(
                                replace(
                                    replace(
                                        replace(
                                            replace(
                                                replace(
                                                    replace(
                                                        replace(
                                                            replace(
                                                                replace(
                                                                    replace(
                                                                        replace(
                                                                            coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
                                                                            '##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
                                                                        ),
                                                                        '##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
                                                                    ),
                                                                    '##Logo##', coalesce(variables('PDF Logo'), '')
                                                                ),
                                                                '##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
                                                            ),
                                                            '##CSMComments##', 
                                                            if(
                                                                equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                                '', 
                                                                coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], '')
                                                            )
                                                        ),
                                                        '##CSMTimestamp##', 
                                                        if(
                                                            equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                            '', 
                                                            coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], '')
                                                        )
                                                    ),
                                                    '##RCOH##', coalesce(outputs('Get_item_18')?['body']?['RCOH']?['DisplayName'], '')
                                                ),
                                                '##RCOHComments##', 
                                                if(
                                                    equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                    '', 
                                                    coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[0], '')
                                                )
                                            ),
                                            '##RCOHTimestamp##', 
                                            if(
                                                equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                '', 
                                                coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[1], '')
                                            )
                                        ),
                                        '##RCXD##', coalesce(split(coalesce(outputs('Get_item_18')?['body']?['RCXD'], ''), ',')[1], 'N/A')
                                    ),
                                    '##RCXDComments##', 
                                    if(
                                        equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                        '', 
                                        coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], '')
                                    )
                                ),
                                '##RCXDTimestamp##', 
                                if(
                                    equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                    '', 
                                    coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], '')
                                )
                            ),
                            '##GCXH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
                        ),
                        '##GCXHComments##', 
                        if(
                            equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                            '', 
                            coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], '')
                        )
                    ),
                    '##GCXHTimestamp##', 
                    if(
                        equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                        '', 
                        coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], '')
                    )
                ),
                '##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
            ),
            '##RFDComments##', 
            if(
                equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
                '', 
                coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], '')
            )
        ),
        '##RFDTimestamp##', 
        if(
            equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
            '', 
            coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], '')
        )
    )





    replace(
                replace(
                    replace(
                        replace(
                            replace(
                                replace(
                                    replace(
                                        replace(
                                            replace(
                                                replace(
                                                    replace(
                                                        coalesce(outputs('Get_item_18')?['body/SaveAsPdfContent'], ''),
                                                        '##ApprovalComments##',
                                                        coalesce(outputs('Get_item_18')?['body/ApprovalComments'], '')
                                                    ),
                                                    '##RequestID##',
                                                    coalesce(outputs('Get_item_18')?['body/RequestID'], '')
                                                ),
                                                '##Logo##',
                                                coalesce(variables('PDF Logo'), '')
                                            ),
                                            'Service Maintance Contract for Distributor',
                                            'Service Maintenance Contract'
                                        ),
                                        '##Status##',
                                        coalesce(outputs('Get_item_18')?['body/Status/Value'], '')
                                    ),
                                    '##GM##',
                                    coalesce(outputs('Get_item_18')?['body/GeneralManager/DisplayName'], '')
                                ),
                                '##GMComments##',
                                coalesce(split(coalesce(outputs('Get_item_18')?['body']?['GMComments'], ''), '##Timestamp:')?[0], '')
                            ),
                            '##GMTimestamp##',
                            coalesce(split(coalesce(outputs('Get_item_18')?['body']?['GMComments'], ''), '##Timestamp:')?[1], '')
                        ),
                        '##BUF##',
                        coalesce(outputs('Get_item_18')?['body/BusinessUnitFinance/DisplayName'], '')
                    ),
                    '##BUFComments##',
                    coalesce(split(coalesce(outputs('Get_item_18')?['body']?['BUFComments'], ''), '##Timestamp:')?[0], '')
                ),
                '##BUFTimestamp##',
                coalesce(split(coalesce(outputs('Get_item_18')?['body']?['BUFComments'], ''), '##Timestamp:')?[1], '')
            )



            replace(
                replace(
                    replace(
                        replace(
                            replace(
                                replace(
                                    replace(
                                        replace(
                                            replace(
                                                replace(
                                                    replace(
                                                        replace(
                                                            replace(
                                                                replace(
                                                                    replace(
                                                                        replace(
                                                                            replace(
                                                                                replace(
                                                                                    coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
                                                                                    '##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
                                                                                ),
                                                                                '##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
                                                                            ),
                                                                            '##Logo##', coalesce(variables('PDF Logo'), '')
                                                                        ),
                                                                        '##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
                                                                    ),
                                                                    '##CSMComments##', 
                                                                    if(
                                                                        equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                                        '', 
                                                                        coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], '')
                                                                    )
                                                                ),
                                                                '##CSMTimestamp##', 
                                                                if(
                                                                    equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                                    '', 
                                                                    coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], '')
                                                                )
                                                            ),
                                                            '##RCOH##', coalesce(outputs('Get_item_18')?['body']?['RCOH']?['DisplayName'], '')
                                                        ),
                                                        '##RCOHComments##', 
                                                        if(
                                                            equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                            '', 
                                                            coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[0], '')
                                                        )
                                                    ),
                                                    '##RCOHTimestamp##', 
                                                    if(
                                                        equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                        '', 
                                                        coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[1], '')
                                                    )
                                                ),
                                                '##RCXD##', coalesce(outputs('Get_item_18')?['body']?['RCXD'], '')
                                            ),
                                            '##RCXDComments##', 
                                            if(
                                                equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                                '', 
                                                coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], '')
                                            )
                                        ),
                                        '##RCXDTimestamp##', 
                                        if(
                                            equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                            '', 
                                            coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], '')
                                        )
                                    ),
                                    '##GCXH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
                                ),
                                '##GCXHComments##', 
                                if(
                                    equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                                    '', 
                                    coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], '')
                                )
                            ),
                            '##GCXHTimestamp##', 
                            if(
                                equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                                '', 
                                coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], '')
                            )
                        ),
                        '##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
                    ),
                    '##RFDComments##', 
                    if(
                        equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
                        '', 
                        coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], '')
                    )
                ),
                '##RFDTimestamp##', 
                if(
                    equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
                    '', 
                    coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], '')
                )
            )

























            replace(
                replace(
                    replace(
                        replace(
                            replace(
                                replace(
                                    replace(
                                        replace(
                                            replace(
                                                replace(
                                                    replace(
                                                        replace(
                                                            replace(
                                                                replace(
                                                                    replace(
                                                                        replace(
                                                                            replace(
                                                                                replace(
                                                                                    coalesce(outputs('Get_item_18')?['body']?['SaveAsPdfContent'], ''),
                                                                                    '##ApprovalComments##', coalesce(outputs('Get_item_18')?['body']?['ApprovalComments'], '')
                                                                                ),
                                                                                '##RequestID##', coalesce(outputs('Get_item_18')?['body']?['RequestID'], '')
                                                                            ),
                                                                            '##Logo##', coalesce(variables('PDF Logo'), '')
                                                                        ),
                                                                        '##CSM##', coalesce(outputs('Get_item_18')?['body']?['CSM']?['DisplayName'], '')
                                                                    ),
                                                                    '##CSMComments##', 
                                                                    if(
                                                                        equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                                        '', 
                                                                        coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[0], '')
                                                                    )
                                                                ),
                                                                '##CSMTimestamp##', 
                                                                if(
                                                                    equals(coalesce(outputs('Get_item_18')?['body']?['CSMComments'], ''), ''), 
                                                                    '', 
                                                                    coalesce(split(outputs('Get_item_18')?['body']?['CSMComments'], '##Timestamp:')?[1], '')
                                                                )
                                                            ),
                                                            '##RCOH##', coalesce(outputs('Get_item_18')?['body']?['RCOH']?['DisplayName'], '')
                                                        ),
                                                        '##RCOHComments##', 
                                                        if(
                                                            equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                            '', 
                                                            coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[0], '')
                                                        )
                                                    ),
                                                    '##RCOHTimestamp##', 
                                                    if(
                                                        equals(coalesce(outputs('Get_item_18')?['body']?['RCOHComments'], ''), ''), 
                                                        '', 
                                                        coalesce(split(outputs('Get_item_18')?['body']?['RCOHComments'], '##Timestamp:')?[1], '')
                                                    )
                                                ),
                                                '##RCXD##', variables('Approver2Displayname')
                                            ),
                                            '##RCXDComments##', 
                                            if(
                                                equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                                '', 
                                                coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[0], '')
                                            )
                                        ),
                                        '##RCXDTimestamp##', 
                                        if(
                                            equals(coalesce(outputs('Get_item_18')?['body']?['RCXDComments'], ''), ''), 
                                            '', 
                                            coalesce(split(outputs('Get_item_18')?['body']?['RCXDComments'], '##Timestamp:')?[1], '')
                                        )
                                    ),
                                    '##GCXH##', coalesce(outputs('Get_item_18')?['body']?['GCXH']?['DisplayName'], '')
                                ),
                                '##GCXHComments##', 
                                if(
                                    equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                                    '', 
                                    coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[0], '')
                                )
                            ),
                            '##GCXHTimestamp##', 
                            if(
                                equals(coalesce(outputs('Get_item_18')?['body']?['GCXHComments'], ''), ''), 
                                '', 
                                coalesce(split(outputs('Get_item_18')?['body']?['GCXHComments'], '##Timestamp:')?[1], '')
                            )
                        ),
                        '##RFD##', coalesce(outputs('Get_item_18')?['body']?['RFD']?['DisplayName'], '')
                    ),
                    '##RFDComments##', 
                    if(
                        equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
                        '', 
                        coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[0], '')
                    )
                ),
                '##RFDTimestamp##', 
                if(
                    equals(coalesce(outputs('Get_item_18')?['body']?['RFDComments'], ''), ''), 
                    '', 
                    coalesce(split(outputs('Get_item_18')?['body']?['RFDComments'], '##Timestamp:')?[1], '')
                )
            )











            if(
    equals(triggerOutputs()?['body/Status/Id'], 1),replace(replace(replace(replace(replace(outputs('Closed_Email_Template_2')?['body/EmailBody'], '##Submitter##', triggerOutputs()?['body/Requestor/DisplayName']), '##FormName##', variables('FormName')), '##Requestor##', triggerOutputs()?['body/Requestor/DisplayName']), '##DateInitiated##', FormatDateTime(triggerOutputs()?['body/SpecialPricingDate'], 'dd-MMM-yyyy')), '##DateToday##', FormatDateTime(utcNow(), 'dd-MMM-yyyy')),
	replace(
        replace(
            replace(
                replace(
                    replace(
                        replace(
                            outputs('Closed_Email_Template_2')?['body/EmailBody'],
                            '##Requestor##', triggerOutputs()?['body/Requestor/DisplayName']
                        ),
                    '##FormName##', variables('FormName')
                    ),
                '##DateInitiated##', formatDateTime(triggerOutputs()?['body/SpecialPricingDate'], 'dd-MMM-yyyy')
                ),
            '##DateRejected##', formatDateTime(utcNow(), 'dd-MMM-yyyy')
            ),
        '##RejectedBy##', triggerOutputs()?['body/Editor/DisplayName']
        ),
	'##RejectedComments##', triggerOutputs()?['body/SOComments']
	)
)